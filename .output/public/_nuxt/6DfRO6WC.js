import{e as U,u as ye,l as Y,o as _e,x as Ue,s as W,y as de,d as Ee,z as fe,c as b,g as s,h as ee,i as se,a as e,q as m,r as x,w as t,j as u,t as _,F as me,m as ve,k as Te,B as De,C as ce,b as C,D as xe,_ as Se,A as Ae}from"./D86ISdAe.js";import{C as Me}from"./Cwql6xvz.js";import{_ as ue}from"./RFizVnyv.js";const we={MESSAGE_SENT:"MessageSent",MESSAGE_READ:"MessageRead",MESSAGE_DELETED:"MessageDeleted",CHAT_CREATED:"ChatCreated",CHAT_UPDATED:"ChatUpdated",CHAT_DELETED:"ChatDeleted",USER_ONLINE:"UserOnline",USER_OFFLINE:"UserOffline",USER_TYPING:"UserTyping",USER_STOPPED_TYPING:"UserStoppedTyping"},be={CHAT:v=>`chat.${v}`,PRIVATE_USER:v=>`private-user.${v}`,PRIVATE_CHAT:v=>`private-chat.${v}`,PUBLIC_CHAT:v=>`public-chat.${v}`,PUBLIC_USERS:"public-users"},Ne=()=>{const v=U([]),d=U(null),c=U([]),D=U(!1),w=U(null),A=U(null),$=ye().user,N=new Me,k=async(o=1)=>{D.value=!0,w.value=null;try{const i=await N.getChats(o);console.log(i),v.value=i.chats||[],A.value=i.pagination}catch(i){w.value=i instanceof Error?i.message:"Failed to load chats",console.error("Load chats error:",i)}finally{D.value=!1}},J=async(o,i="user")=>{D.value=!0,w.value=null;try{const p=await N.createPrivateChat(o,i);if(console.log("ðŸš€ Chat criado:",p),!p||!p.id)throw new Error("Chat created without valid ID");return v.value.find(r=>r.id===p.id)||v.value.unshift(p),d.value=p,console.log("ðŸŽ¯ CurrentChat definido:",d.value),await B(p.id),p}catch(p){throw w.value=p instanceof Error?p.message:"Failed to start chat",console.error("Start chat error:",p),p}finally{D.value=!1}},R=async(o,i=1)=>{var p;console.log("ðŸ“¥ loadChatMessages chamado para chat ID:",o),D.value=!0,w.value=null;try{const g=await N.getChatMessages(o,i);console.log("ðŸ“¥ Resposta do getChatMessages:",g),console.log("ðŸ“¥ Messages array:",g.messages),console.log("ðŸ“¥ Messages length:",(p=g.messages)==null?void 0:p.length),i===1?(c.value=g.messages,console.log("ðŸ“¥ Messages definidos:",c.value)):c.value.unshift(...g.messages)}catch(g){w.value=g instanceof Error?g.message:"Failed to load messages",console.error("Load chat messages error:",g)}finally{D.value=!1}},K=async o=>{if(console.log("ðŸ“¤ Tentando enviar mensagem:",{currentChat:d.value,content:o}),!d.value||!d.value.id||!o.trim()){console.error("Send message error: currentChat or chat ID is undefined",d.value);return}try{console.log("ðŸ“¤ Enviando mensagem para chat ID:",d.value.id);const i=await N.sendMessageToChat(d.value.id,o);return d.value&&(d.value.last_message=i,d.value.unread_count=0),i}catch(i){throw w.value=i instanceof Error?i.message:"Failed to send message",console.error("Send message error:",i),i}},Q=async(o,i,p="user")=>{try{const g=await N.sendMessageToUser(o,i,p);return v.value.find(l=>l.id===g.chat.id)||v.value.unshift(g.chat),d.value=g.chat,g}catch(g){throw w.value=g instanceof Error?g.message:"Failed to send message",console.error("Send message to user error:",g),g}},H=async o=>{console.log("ðŸŽ¯ selectChat chamado com:",o),console.log("ðŸŽ¯ Chat ID:",o.id),d.value={...o},console.log("ðŸŽ¯ CurrentChat definido:",d.value),await R(o.id),await B(o.id)},G=o=>N.getChatDisplayName(o),f=o=>N.formatMessage(o),T=o=>{var i;return o.sender_id===((i=$.value)==null?void 0:i.id)},E=Y(()=>v.value.filter(o=>o.unread_count>0)),z=Y(()=>v.value.reduce((o,i)=>o+i.unread_count,0)),F=Y(()=>{console.log("ðŸŽ¨ formattedMessages computed chamada"),console.log("ðŸŽ¨ messages.value:",c.value),console.log("ðŸŽ¨ messages.value.length:",c.value.length);const o=c.value.map(i=>f(i));return console.log("ðŸŽ¨ formatted result:",o),o}),I=()=>{try{console.log("ðŸ”” setupPusherListener iniciado");const{$pusher:o}=de();if(console.log("ðŸ”” Pusher obtido:",o),!o){console.warn("âš ï¸ Pusher nÃ£o disponÃ­vel para listener");return}console.log("ðŸ”” Configurando listener do Pusher para novas mensagens...");const i=ye().user.value;console.log("ðŸ”” UsuÃ¡rio atual:",i),i!=null&&i.id?(console.log("ðŸ”” Chats disponÃ­veis para configurar listener:",v.value),v.value.forEach(p=>{const g=be.CHAT(p.id);console.log("ðŸ”” Configurando listener para canal:",g);try{if(o.channel(g)){console.log(`ðŸ”” JÃ¡ inscrito no canal ${g}, pulando...`);return}const r=o.subscribe(g);console.log("ðŸ”” Canal inscrito:",r),r.bind(we.MESSAGE_SENT,l=>{var V;console.log("ðŸ”” Nova mensagem recebida via Pusher:",l);let S=l.created_at;try{if(S){const h=new Date(S);isNaN(h.getTime())&&(console.warn("âš ï¸ Data invÃ¡lida recebida do Pusher:",S),S=new Date().toISOString())}}catch(h){console.warn("âš ï¸ Erro ao processar data do Pusher:",h),S=new Date().toISOString()}const M={id:l.id,chat_id:l.chat_id,content:l.content,sender_id:l.sender_id,sender_type:l.sender_type,message_type:"text",metadata:null,is_read:l.is_read,read_at:null,created_at:S,updated_at:S};c.value.push(M),console.log("ðŸ”” Mensagem adicionada ao estado:",M);const O=v.value.findIndex(h=>h.id===l.chat_id);O!==-1&&(v.value[O].last_message=M,v.value[O].unread_count=(v.value[O].unread_count||0)+1,console.log("ðŸ”” Chat atualizado com nova mensagem")),((V=d.value)==null?void 0:V.id)===l.chat_id&&window.dispatchEvent(new CustomEvent("scroll-to-bottom"))}),console.log(`âœ… Listener configurado para chat ${p.id} no canal ${g}`)}catch(r){console.error(`âŒ Erro ao configurar listener para chat ${p.id}:`,r)}})):console.warn("âš ï¸ UsuÃ¡rio nÃ£o autenticado, nÃ£o Ã© possÃ­vel configurar listener"),console.log("âœ… Listener do Pusher configurado com sucesso")}catch(o){console.error("âŒ Erro ao configurar listener do Pusher:",o)}},B=async o=>{try{console.log(`ðŸ”” setupPusherListenerForChat iniciado para chat ID: ${o}`);const{$pusher:i}=de();if(!i){console.warn("âš ï¸ Pusher nÃ£o disponÃ­vel para listener de chat especÃ­fico");return}const p=be.CHAT(o);console.log("ðŸ”” Configurando listener para canal:",p);const g=i.subscribe(p);console.log("ðŸ”” Canal inscrito:",g),g.bind(we.MESSAGE_SENT,r=>{var O;console.log("ðŸ”” Nova mensagem recebida via Pusher para chat:",o,r);let l=r.created_at;try{if(l){const V=new Date(l);isNaN(V.getTime())&&(console.warn("âš ï¸ Data invÃ¡lida recebida do Pusher para chat:",o,l),l=new Date().toISOString())}}catch(V){console.warn("âš ï¸ Erro ao processar data do Pusher para chat:",o,V),l=new Date().toISOString()}const S={id:r.id,chat_id:r.chat_id,content:r.content,sender_id:r.sender_id,sender_type:r.sender_type,message_type:"text",metadata:null,is_read:r.is_read,read_at:null,created_at:l,updated_at:l};c.value.push(S),console.log("ðŸ”” Mensagem adicionada ao estado para chat:",o,S);const M=v.value.findIndex(V=>V.id===r.chat_id);M!==-1&&(v.value[M].last_message=S,v.value[M].unread_count=(v.value[M].unread_count||0)+1,console.log("ðŸ”” Chat atualizado com nova mensagem para chat:",o)),((O=d.value)==null?void 0:O.id)===r.chat_id&&window.dispatchEvent(new CustomEvent("scroll-to-bottom"))}),console.log(`âœ… Listener do Pusher configurado com sucesso para chat ${o}`)}catch(i){console.error(`âŒ Erro ao configurar listener do Pusher para chat ${o}:`,i)}},j=()=>{try{console.log("ðŸ§ª Testando conexÃ£o do Pusher...");const{$pusher:o}=de();if(!o){console.error("âŒ Pusher nÃ£o disponÃ­vel para teste");return}const i=o.subscribe("test-channel");i.bind("pusher:subscription_succeeded",()=>{console.log("âœ… Conectado ao canal de teste"),console.log("âœ… Connection ID:",o.connection.connection.id)}),i.bind("pusher:subscription_error",p=>{console.error("âŒ Erro na inscriÃ§Ã£o:",p)}),console.log("ðŸ§ª Teste de conexÃ£o iniciado")}catch(o){console.error("âŒ Erro no teste de conexÃ£o:",o)}},te=()=>{try{const{$pusher:o}=de();o&&(console.log("ðŸ”” Limpando listener do Pusher..."),o.disconnect())}catch(o){console.error("âŒ Erro ao limpar listener do Pusher:",o)}};return _e(()=>{console.log("ðŸš€ useChatManager - onMounted chamado"),console.log("ðŸš€ Chats disponÃ­veis:",v.value),console.log("ðŸš€ UsuÃ¡rio atual:",$.value),setTimeout(()=>{console.log("ðŸš€ Executando setupPusherListener apÃ³s delay"),I()},1e3)}),Ue(()=>{te()}),{chats:W(v),currentChat:W(d),messages:W(c),loading:W(D),error:W(w),pagination:W(A),unreadChats:E,totalUnread:z,formattedMessages:F,currentUser:$,loadChats:k,startChatWithUser:J,loadChatMessages:R,sendMessage:K,sendMessageToUser:Q,selectChat:H,getChatDisplayName:G,formatMessage:f,isOwnMessage:T,testPusherConnection:j,setupPusherListenerForChat:B}},Ve={class:"chat-interface"},Le={class:"chat-header"},ze={class:"d-flex align-center justify-space-between w-100"},Ie={class:"d-flex align-center"},Re={class:"text-h6"},Fe={key:0,class:"text-caption text-grey"},Oe={key:1,class:"text-caption text-grey"},He={class:"d-flex align-center"},Ge={key:0,class:"conversations-list"},Be={key:0,class:"text-center pa-4"},je={key:1,class:"pa-4"},Ke={key:2,class:"text-center pa-8"},We={key:3,class:"chats"},Ye=["onClick"],qe={class:"conversation-avatar"},Je={class:"conversation-content"},Qe={class:"conversation-header"},Xe={class:"text-subtitle-1 font-weight-medium"},Ze={class:"text-caption text-grey"},et={class:"text-body-2 text-grey conversation-preview"},tt={key:1,class:"chat-main"},at={key:0,class:"text-center pa-4"},st={key:1,class:"pa-4"},ot={key:2,class:"text-center pa-8"},lt={class:"text-body-2 text-grey"},nt={key:3,class:"messages-list"},rt={class:"message-content"},it={class:"message-header"},dt={class:"message-author"},ct={class:"message-time"},ut={class:"message-text"},mt={class:"chat-input"},vt={key:0,class:"send-error mb-2"},gt={class:"d-flex align-end"},pt=Ee({__name:"ChatInterface",props:{initialUser:{default:null},initialChat:{default:null}},emits:["close"],setup(v,{emit:d}){const c=v,D=d,w=U(""),A=U(),$=U(""),{chats:N,currentChat:k,messages:J,loading:R,error:K,formattedMessages:Q,loadChats:H,loadChatMessages:G,selectChat:f,sendMessage:T,startChatWithUser:E,getChatDisplayName:z,testPusherConnection:F}=Ne(),I=Y(()=>k.value?z(k.value):c.initialUser?`Chat com ${c.initialUser.name}`:"Chat"),B=()=>{D("close")},j=async()=>{if(w.value.trim()){console.log("ðŸ’¬ handleSendMessage chamado:",{currentChat:k.value,initialUser:c.initialUser,message:w.value});try{if($.value="",k.value)console.log("ðŸ’¬ Enviando mensagem para chat existente:",k.value.id),await T(w.value),w.value="";else if(c.initialUser){console.log("ðŸ’¬ Criando novo chat com usuÃ¡rio:",c.initialUser.id);const r=await E(c.initialUser.id,"user");r&&r.id&&(await ce(),await T(w.value),w.value="")}}catch(r){console.error("Erro ao enviar mensagem:",r),$.value="Erro ao enviar mensagem. Tente novamente.",setTimeout(()=>{$.value=""},3e3)}}},te=async()=>{if(c.initialUser&&!k.value)try{console.log("ðŸš€ Iniciando chat com usuÃ¡rio:",c.initialUser);const r=await E(c.initialUser.id,"user");r&&r.id&&(console.log("ðŸ“¥ Carregando mensagens do chat criado:",r.id),await ce(),await G(r.id))}catch(r){console.error("Erro ao inicializar chat:",r),$.value="Erro ao inicializar chat. Tente novamente.",setTimeout(()=>{$.value=""},5e3)}},o=()=>{},i=()=>{ce(()=>{A.value&&(A.value.scrollTop=A.value.scrollHeight)})},p=r=>{if(!r)return"--:--";try{const l=new Date(r);return isNaN(l.getTime())?"--:--":l.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}catch(l){return console.warn("Erro ao formatar data:",l,r),"--:--"}},g=r=>r.isOwn?"VocÃª":r.user_name||"UsuÃ¡rio";return _e(async()=>{c.initialUser||await H(),await te(),window.addEventListener("scroll-to-bottom",i)}),Ue(()=>{window.removeEventListener("scroll-to-bottom",i)}),fe(()=>c.initialChat,r=>{r&&f(r)},{immediate:!0}),fe(()=>c.initialUser,async r=>{if(r&&!k.value)try{await te()}catch(l){console.error("Erro ao inicializar chat com usuÃ¡rio:",l),$.value="Erro ao inicializar chat. Tente novamente.",setTimeout(()=>{$.value=""},5e3)}},{immediate:!0}),fe(k,()=>{k.value&&ce(()=>{i()})}),console.log("ðŸŽ¯ ChatInterface carregado com initialChat:",c.initialChat,"initialUser:",c.initialUser),(r,l)=>{const S=x("v-icon"),M=x("v-btn"),O=x("v-progress-circular"),V=x("v-alert"),h=x("v-avatar"),a=x("v-badge"),P=x("v-text-field"),L=x("v-form");return C(),b("div",Ve,[s("div",Le,[s("div",ze,[s("div",Ie,[m(k)?(C(),ee(M,{key:0,onClick:B,icon:"",size:"small",variant:"text",class:"mr-2"},{default:t(()=>[e(S,null,{default:t(()=>l[2]||(l[2]=[u("mdi-arrow-left")])),_:1})]),_:1})):se("",!0),e(S,{color:"primary",class:"mr-2"},{default:t(()=>l[3]||(l[3]=[u("mdi-chat")])),_:1}),s("div",null,[s("h3",Re,_(I.value),1),m(k)?(C(),b("p",Fe,_(m(k).type==="private"?"Chat privado":"Chat em grupo"),1)):r.initialUser?(C(),b("p",Oe,_(r.initialUser.email),1)):se("",!0)])]),s("div",He,[e(M,{onClick:m(F),icon:"",size:"small",variant:"text",class:"mr-2",title:"Testar conexÃ£o Pusher"},{default:t(()=>[e(S,null,{default:t(()=>l[4]||(l[4]=[u("mdi-wifi")])),_:1})]),_:1},8,["onClick"]),e(M,{onClick:l[0]||(l[0]=y=>r.$emit("close")),icon:"",size:"small",variant:"text"},{default:t(()=>[e(S,null,{default:t(()=>l[5]||(l[5]=[u("mdi-close")])),_:1})]),_:1})])])]),!m(k)&&!r.initialUser?(C(),b("div",Ge,[m(R)?(C(),b("div",Be,[e(O,{indeterminate:"",color:"primary"})])):m(K)?(C(),b("div",je,[e(V,{type:"error",variant:"tonal"},{default:t(()=>[u(_(m(K)),1)]),_:1})])):m(N).length===0?(C(),b("div",Ke,[e(S,{size:"64",color:"grey",class:"mb-4"},{default:t(()=>l[6]||(l[6]=[u("mdi-chat-outline")])),_:1}),l[7]||(l[7]=s("h3",{class:"text-h6 mb-2"},"Nenhum chat",-1)),l[8]||(l[8]=s("p",{class:"text-body-2 text-grey"}," Inicie um chat com um usuÃ¡rio para comeÃ§ar a conversar. ",-1))])):(C(),b("div",We,[(C(!0),b(me,null,ve(m(N),y=>{var oe,X,ae;return C(),b("div",{key:y.id,onClick:he=>m(f)(y),class:xe(["conversation-item",{active:((oe=m(k))==null?void 0:oe.id)===y.id}])},[s("div",qe,[e(h,{size:"48",color:"primary"},{default:t(()=>[e(S,null,{default:t(()=>l[9]||(l[9]=[u("mdi-account")])),_:1})]),_:1}),y.unread_count>0?(C(),ee(a,{key:0,content:y.unread_count,color:"error",dot:"",class:"conversation-badge"},null,8,["content"])):se("",!0)]),s("div",Je,[s("div",Qe,[s("h4",Xe,_(m(z)(y)),1),s("span",Ze,_(p((X=y.last_message)==null?void 0:X.created_at)),1)]),s("p",et,_(((ae=y.last_message)==null?void 0:ae.content)||"Nenhuma mensagem ainda"),1)])],10,Ye)}),128))]))])):(C(),b("div",tt,[s("div",{ref_key:"messagesContainer",ref:A,class:"chat-messages",onScroll:o},[m(R)?(C(),b("div",at,[e(O,{indeterminate:"",color:"primary"})])):m(K)?(C(),b("div",st,[e(V,{type:"error",variant:"tonal"},{default:t(()=>[u(_(m(K)),1)]),_:1})])):m(J).length===0?(C(),b("div",ot,[e(S,{size:"64",color:"grey",class:"mb-4"},{default:t(()=>l[10]||(l[10]=[u("mdi-message-outline")])),_:1}),l[11]||(l[11]=s("h3",{class:"text-h6 mb-2"},"Nenhuma mensagem",-1)),s("p",lt,_(r.initialUser?`Inicie um chat com ${r.initialUser.name}!`:"Seja o primeiro a enviar uma mensagem!"),1)])):(C(),b("div",nt,[(C(!0),b(me,null,ve(m(Q),y=>(C(),b("div",{key:y.id,class:xe(["message-item",{"message-own":y.isOwn}])},[s("div",rt,[s("div",it,[s("span",dt,_(g(y)),1),s("span",ct,_(y.time),1)]),s("div",ut,_(y.content),1)])],2))),128))]))],544),s("div",mt,[$.value?(C(),b("div",vt,[e(V,{type:"error",variant:"tonal",density:"compact"},{default:t(()=>[u(_($.value),1)]),_:1})])):se("",!0),e(L,{onSubmit:Te(j,["prevent"])},{default:t(()=>[s("div",gt,[e(P,{modelValue:w.value,"onUpdate:modelValue":l[1]||(l[1]=y=>w.value=y),onKeydown:De(j,["enter"]),placeholder:r.initialUser?`Digite uma mensagem para ${r.initialUser.name}...`:"Digite sua mensagem...",variant:"outlined",density:"compact","hide-details":"",class:"flex-grow-1 mr-2",disabled:m(R)},null,8,["modelValue","placeholder","disabled"]),e(M,{onClick:j,color:"primary",icon:"",disabled:!w.value.trim()||m(R)},{default:t(()=>[e(S,null,{default:t(()=>l[12]||(l[12]=[u("mdi-send")])),_:1})]),_:1},8,["disabled"])])]),_:1})])]))])}}}),ft=Se(pt,[["__scopeId","data-v-72bf487a"]]),_t=()=>{const v=U([]),d=U(null),c=U(!1),D=U(null),w=new Ae,A=async(f=1,T=15)=>{c.value=!0,D.value=null;try{const E=await w.getUsers(f,T);E.success&&E.data?(v.value=E.data.users,d.value=E.data.pagination):D.value=E.error||"Failed to load users"}catch{D.value="Unexpected error loading users"}finally{c.value=!1}},$=()=>{d.value&&d.value.current_page<d.value.last_page&&A(d.value.current_page+1,d.value.per_page)},N=()=>{d.value&&d.value.current_page>1&&A(d.value.current_page-1,d.value.per_page)},k=f=>{d.value&&f>=1&&f<=d.value.last_page&&A(f,d.value.per_page)},J=f=>{A(1,f)},R=f=>({...f,role:"User",status:f.email_verified_at?"Ativo":"Pendente",statusColor:f.email_verified_at?"success":"warning",avatar:`/images/profile/user-${f.id%8+1}.jpg`,phone:`+55 (11) ${String(f.id).padStart(5,"0")}-${String(f.id).padStart(4,"0")}`,department:"TI",lastLogin:f.email_verified_at?f.updated_at:"Nunca"}),K=Y(()=>v.value.map(R)),Q=Y(()=>d.value&&d.value.current_page<d.value.last_page),H=Y(()=>d.value&&d.value.current_page>1),G=Y(()=>{if(!d.value)return[];const f=[],T=d.value.current_page,E=d.value.last_page;let z=Math.max(1,T-2),F=Math.min(E,T+2);T<=3?F=Math.min(E,5):T>=E-2&&(z=Math.max(1,E-4));for(let I=z;I<=F;I++)f.push(I);return f});return{users:W(v),pagination:W(d),loading:W(c),error:W(D),formattedUsers:K,canGoNext:Q,canGoPrev:H,pageNumbers:G,loadUsers:A,nextPage:$,prevPage:N,goToPage:k,changePerPage:J,formatUserForDisplay:R}},ht={class:"d-flex align-center justify-space-between"},Ct={class:"d-flex gap-2"},yt={class:"d-flex justify-center align-center py-8"},xt={class:"d-flex align-center"},wt=["src","alt"],bt={class:"font-weight-medium"},Ut={class:"text-caption text-medium-emphasis"},Et={class:"d-flex justify-center gap-1"},St={key:0,class:"d-flex align-center justify-space-between mt-4"},kt={class:"text-body-2 text-medium-emphasis"},Pt={class:"d-flex align-center gap-2"},$t={class:"d-flex gap-1"},Tt={class:"text-body-2"},Dt={class:"d-flex align-center gap-3"},At={class:"text-h6"},Mt={class:"text-caption text-medium-emphasis"},Nt=Ee({__name:"index",setup(v){const{formattedUsers:d,pagination:c,loading:D,error:w,loadUsers:A,nextPage:$,prevPage:N,goToPage:k,changePerPage:J,canGoNext:R,canGoPrev:K,pageNumbers:Q}=_t(),H=U(""),G=U("all"),f=U("all"),T=U("all"),E=U(!1),z=U(!1),F=U(!1),I=U(null),B=U(!1),j=U(null),te=[{value:"all",label:"All Status"},{value:"Ativo",label:"Active"},{value:"Pendente",label:"Pending"}],o=[{value:"all",label:"All Roles"},{value:"User",label:"User"}],i=[{value:"all",label:"All Departments"},{value:"TI",label:"IT"}],p=Y(()=>d.value.filter(h=>{const a=h.name.toLowerCase().includes(H.value.toLowerCase())||h.email.toLowerCase().includes(H.value.toLowerCase()),P=G.value==="all"||h.status===G.value,L=f.value==="all"||h.role===f.value,y=T.value==="all"||h.department===T.value;return a&&P&&L&&y})),g=()=>{E.value=!0},r=h=>{I.value={...h},z.value=!0},l=h=>{I.value=h,F.value=!0},S=()=>{var h,a;I.value&&(F.value=!1,I.value=null,A(((h=c.value)==null?void 0:h.current_page)||1,((a=c.value)==null?void 0:a.per_page)||15))},M=h=>{h.status==="Active"?(h.status="Pending",h.statusColor="warning"):(h.status="Active",h.statusColor="success")},O=async h=>{console.log("Starting chat with user:",h),j.value=h,B.value=!0},V=()=>{H.value="",G.value="all",f.value="all",T.value="all"};return _e(()=>{A()}),(h,a)=>{const P=x("v-btn"),L=x("v-col"),y=x("v-row"),oe=x("v-text-field"),X=x("v-select"),ae=x("v-chip"),he=x("v-progress-circular"),ke=x("v-alert"),Ce=x("v-avatar"),q=x("v-icon"),Pe=x("v-table"),le=x("v-card-title"),ne=x("v-card-text"),ge=x("v-spacer"),pe=x("v-card-actions"),re=x("v-card"),ie=x("v-dialog"),$e=ft;return C(),b("div",null,[e(y,{class:"mb-4"},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[s("div",ht,[a[16]||(a[16]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold"},"Users"),s("p",{class:"text-body-1 text-medium-emphasis"}," Manage all system users ")],-1)),e(P,{color:"primary","prepend-icon":"mdi-plus",onClick:g,size:"large"},{default:t(()=>a[15]||(a[15]=[u(" Add User ")])),_:1})])]),_:1})]),_:1}),e(y,{class:"mb-6"},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(ue,{title:"Filters"},{default:t(()=>[e(y,null,{default:t(()=>[e(L,{cols:"12",md:"3"},{default:t(()=>[e(oe,{modelValue:H.value,"onUpdate:modelValue":a[0]||(a[0]=n=>H.value=n),label:"Search by name or email","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(L,{cols:"12",md:"3"},{default:t(()=>[e(X,{modelValue:G.value,"onUpdate:modelValue":a[1]||(a[1]=n=>G.value=n),items:te,"item-title":"label","item-value":"value",label:"Status",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(L,{cols:"12",md:"3"},{default:t(()=>[e(X,{modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=n=>f.value=n),items:o,"item-title":"label","item-value":"value",label:"Role",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(L,{cols:"12",md:"3"},{default:t(()=>[e(X,{modelValue:T.value,"onUpdate:modelValue":a[3]||(a[3]=n=>T.value=n),items:i,"item-title":"label","item-value":"value",label:"Department",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[s("div",Ct,[e(P,{variant:"outlined",onClick:V,"prepend-icon":"mdi-refresh"},{default:t(()=>a[17]||(a[17]=[u(" Clear Filters ")])),_:1}),e(ae,{color:"primary",variant:"tonal",class:"ml-auto"},{default:t(()=>[u(_(p.value.length)+" users found ",1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),m(D)?(C(),ee(y,{key:0},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(ue,null,{default:t(()=>[s("div",yt,[e(he,{indeterminate:"",color:"primary",size:"64"})])]),_:1})]),_:1})]),_:1})):m(w)?(C(),ee(y,{key:1},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(ue,null,{default:t(()=>[e(ke,{type:"error",variant:"tonal",class:"mb-0"},{default:t(()=>[u(_(m(w)),1)]),_:1})]),_:1})]),_:1})]),_:1})):(C(),ee(y,{key:2},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(ue,{title:"Users List"},{default:t(()=>[e(Pe,{"fixed-header":"",height:"600px"},{default:t(()=>[a[21]||(a[21]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"User"),s("th",{class:"text-left"},"Email"),s("th",{class:"text-left"},"Role"),s("th",{class:"text-left"},"Department"),s("th",{class:"text-left"},"Status"),s("th",{class:"text-left"},"Last Login"),s("th",{class:"text-left"},"Created At"),s("th",{class:"text-center"},"Actions")])],-1)),s("tbody",null,[(C(!0),b(me,null,ve(p.value,n=>(C(),b("tr",{key:n.id},[s("td",null,[s("div",xt,[e(Ce,{size:"40",class:"mr-3"},{default:t(()=>[s("img",{src:n.avatar,alt:n.name},null,8,wt)]),_:2},1024),s("div",null,[s("div",bt,_(n.name),1),s("div",Ut,_(n.phone),1)])])]),s("td",null,_(n.email),1),s("td",null,[e(ae,{color:n.role==="Admin"?"error":n.role==="Manager"?"warning":n.role==="Editor"?"info":"default",variant:"tonal",size:"small"},{default:t(()=>[u(_(n.role),1)]),_:2},1032,["color"])]),s("td",null,_(n.department),1),s("td",null,[e(ae,{color:n.statusColor,variant:"tonal",size:"small"},{default:t(()=>[u(_(n.status),1)]),_:2},1032,["color"])]),s("td",null,_(n.lastLogin),1),s("td",null,_(new Date(n.created_at).toLocaleDateString("pt-BR")),1),s("td",null,[s("div",Et,[e(P,{icon:"",size:"small",variant:"text",color:"info",onClick:Z=>O(n),title:"Start Chat"},{default:t(()=>[e(q,null,{default:t(()=>a[18]||(a[18]=[u("mdi-chat")])),_:1})]),_:2},1032,["onClick"]),e(P,{icon:"",size:"small",variant:"text",color:"primary",onClick:Z=>r(n),title:"Edit"},{default:t(()=>[e(q,null,{default:t(()=>a[19]||(a[19]=[u("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),e(P,{icon:"",size:"small",variant:"text",color:n.status==="Active"?"warning":"success",onClick:Z=>M(n),title:n.status==="Active"?"Deactivate":"Activate"},{default:t(()=>[e(q,null,{default:t(()=>[u(_(n.status==="Active"?"mdi-account-off":"mdi-account-check"),1)]),_:2},1024)]),_:2},1032,["color","onClick","title"]),e(P,{icon:"",size:"small",variant:"text",color:"error",onClick:Z=>l(n),title:"Delete"},{default:t(()=>[e(q,null,{default:t(()=>a[20]||(a[20]=[u("mdi-delete")])),_:1})]),_:2},1032,["onClick"])])])]))),128))])]),_:1}),m(c)?(C(),b("div",St,[s("div",kt," Showing "+_(m(c).from)+" to "+_(m(c).to)+" of "+_(m(c).total)+" users ",1),s("div",Pt,[e(X,{"model-value":m(c).per_page,"onUpdate:modelValue":m(J),items:[10,15,25,50],variant:"outlined",density:"compact","hide-details":"",style:{width:"80px"}},null,8,["model-value","onUpdate:modelValue"]),e(P,{icon:"",variant:"text",disabled:!m(K),onClick:m(N),title:"Previous page"},{default:t(()=>[e(q,null,{default:t(()=>a[22]||(a[22]=[u("mdi-chevron-left")])),_:1})]),_:1},8,["disabled","onClick"]),s("div",$t,[(C(!0),b(me,null,ve(m(Q),n=>(C(),ee(P,{key:n,color:n===m(c).current_page?"primary":void 0,variant:"text",size:"small",onClick:Z=>m(k)(n)},{default:t(()=>[u(_(n),1)]),_:2},1032,["color","onClick"]))),128))]),e(P,{icon:"",variant:"text",disabled:!m(R),onClick:m($),title:"Next page"},{default:t(()=>[e(q,null,{default:t(()=>a[23]||(a[23]=[u("mdi-chevron-right")])),_:1})]),_:1},8,["disabled","onClick"])])])):se("",!0)]),_:1})]),_:1})]),_:1})),e(ie,{modelValue:E.value,"onUpdate:modelValue":a[6]||(a[6]=n=>E.value=n),"max-width":"600px"},{default:t(()=>[e(re,null,{default:t(()=>[e(le,{class:"text-h5"},{default:t(()=>a[24]||(a[24]=[u(" Add New User ")])),_:1}),e(ne,null,{default:t(()=>a[25]||(a[25]=[s("p",{class:"text-body-2 text-medium-emphasis"}," User addition form will be implemented here. ",-1)])),_:1}),e(pe,null,{default:t(()=>[e(ge),e(P,{color:"grey-darken-1",variant:"text",onClick:a[4]||(a[4]=n=>E.value=!1)},{default:t(()=>a[26]||(a[26]=[u(" Cancel ")])),_:1}),e(P,{color:"primary",onClick:a[5]||(a[5]=n=>E.value=!1)},{default:t(()=>a[27]||(a[27]=[u(" Add ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ie,{modelValue:z.value,"onUpdate:modelValue":a[9]||(a[9]=n=>z.value=n),"max-width":"600px"},{default:t(()=>[e(re,null,{default:t(()=>[e(le,{class:"text-h5"},{default:t(()=>a[28]||(a[28]=[u(" Edit User ")])),_:1}),e(ne,null,{default:t(()=>a[29]||(a[29]=[s("p",{class:"text-body-2 text-medium-emphasis"}," Edit form will be implemented here. ",-1)])),_:1}),e(pe,null,{default:t(()=>[e(ge),e(P,{color:"grey-darken-1",variant:"text",onClick:a[7]||(a[7]=n=>z.value=!1)},{default:t(()=>a[30]||(a[30]=[u(" Cancel ")])),_:1}),e(P,{color:"primary",onClick:a[8]||(a[8]=n=>z.value=!1)},{default:t(()=>a[31]||(a[31]=[u(" Save ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ie,{modelValue:F.value,"onUpdate:modelValue":a[11]||(a[11]=n=>F.value=n),"max-width":"400px"},{default:t(()=>[e(re,null,{default:t(()=>[e(le,{class:"text-h5"},{default:t(()=>a[32]||(a[32]=[u(" Confirm Deletion ")])),_:1}),e(ne,null,{default:t(()=>{var n;return[s("p",Tt,[a[33]||(a[33]=u(" Are you sure you want to delete the user ")),s("strong",null,_((n=I.value)==null?void 0:n.name),1),a[34]||(a[34]=u("? "))]),a[35]||(a[35]=s("p",{class:"text-caption text-medium-emphasis"}," This action cannot be undone. ",-1))]}),_:1}),e(pe,null,{default:t(()=>[e(ge),e(P,{color:"grey-darken-1",variant:"text",onClick:a[10]||(a[10]=n=>F.value=!1)},{default:t(()=>a[36]||(a[36]=[u(" Cancel ")])),_:1}),e(P,{color:"error",onClick:S},{default:t(()=>a[37]||(a[37]=[u(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ie,{modelValue:B.value,"onUpdate:modelValue":a[14]||(a[14]=n=>B.value=n),"max-width":"800px",persistent:""},{default:t(()=>[e(re,{class:"chat-dialog-card"},{default:t(()=>[e(le,{class:"d-flex align-center justify-space-between pa-4"},{default:t(()=>{var n,Z;return[s("div",Dt,[e(Ce,{size:"40",color:"primary"},{default:t(()=>[e(q,null,{default:t(()=>a[38]||(a[38]=[u("mdi-account")])),_:1})]),_:1}),s("div",null,[s("div",At,"Chat with "+_((n=j.value)==null?void 0:n.name),1),s("div",Mt,_((Z=j.value)==null?void 0:Z.email),1)])]),e(P,{icon:"",variant:"text",onClick:a[12]||(a[12]=Vt=>B.value=!1),title:"Close"},{default:t(()=>[e(q,null,{default:t(()=>a[39]||(a[39]=[u("mdi-close")])),_:1})]),_:1})]}),_:1}),e(ne,{class:"chat-dialog-content pa-0"},{default:t(()=>[j.value?(C(),ee($e,{key:0,"initial-chat":null,"initial-user":j.value,onClose:a[13]||(a[13]=n=>B.value=!1)},null,8,["initial-user"])):se("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Rt=Se(Nt,[["__scopeId","data-v-d7858c6b"]]);export{Rt as default};
