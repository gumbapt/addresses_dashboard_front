import{e as S,u as ye,x as De,l as K,o as _e,y as Ue,s as G,z as ce,d as Ee,B as pe,c as E,g as s,h as ee,i as ae,a as t,q as m,r as w,w as a,j as d,t as f,F as me,m as ve,k as Ae,C as Te,D as ue,b as _,E as xe,_ as Se,A as Me}from"./DeT5GG9l.js";import{C as Ne}from"./9_js0_E2.js";import{_ as de}from"./BhAq8yXs.js";const we={MESSAGE_SENT:"MessageSent",MESSAGE_READ:"MessageRead",MESSAGE_DELETED:"MessageDeleted",CHAT_CREATED:"ChatCreated",CHAT_UPDATED:"ChatUpdated",CHAT_DELETED:"ChatDeleted",USER_ONLINE:"UserOnline",USER_OFFLINE:"UserOffline",USER_TYPING:"UserTyping",USER_STOPPED_TYPING:"UserStoppedTyping"},be={CHAT:v=>`chat.${v}`,PRIVATE_USER:v=>`private-user.${v}`,PRIVATE_CHAT:v=>`private-chat.${v}`,PUBLIC_CHAT:v=>`public-chat.${v}`,PUBLIC_USERS:"public-users"},Ve=()=>{const v=S([]),c=S(null),u=S([]),D=S(!1),b=S(null),A=S(null),P=ye().user,k=De().public.chatApiUrl,V=new Ne(k),R=async(o=1)=>{D.value=!0,b.value=null;try{const i=await V.getChats(o);console.log(i),v.value=i.chats||[],A.value=i.pagination}catch(i){b.value=i instanceof Error?i.message:"Failed to load chats",console.error("Load chats error:",i)}finally{D.value=!1}},B=async(o,i="user")=>{D.value=!0,b.value=null;try{const n=await V.createPrivateChat(o,i);if(console.log("ðŸš€ Chat created:",n),!n||!n.id)throw new Error("Chat created without valid ID");return v.value.find(h=>h.id===n.id)||v.value.unshift(n),c.value=n,console.log("ðŸŽ¯ CurrentChat set:",c.value),await Y(n.id),n}catch(n){throw b.value=n instanceof Error?n.message:"Failed to start chat",console.error("Start chat error:",n),n}finally{D.value=!1}},W=async(o,i=1)=>{var n;console.log("ðŸ“¥ loadChatMessages chamado para chat ID:",o),D.value=!0,b.value=null;try{const l=await V.getChatMessages(o,i);console.log("ðŸ“¥ getChatMessages response:",l),console.log("ðŸ“¥ Messages array:",l.messages),console.log("ðŸ“¥ Messages length:",(n=l.messages)==null?void 0:n.length),i===1?(u.value=l.messages,console.log("ðŸ“¥ Messages set:",u.value)):u.value.unshift(...l.messages)}catch(l){b.value=l instanceof Error?l.message:"Failed to load messages",console.error("Load chat messages error:",l)}finally{D.value=!1}},F=async o=>{if(console.log("ðŸ“¤ Attempting to send message:",{currentChat:c.value,content:o}),!c.value||!c.value.id||!o.trim()){console.error("Send message error: currentChat or chat ID is undefined",c.value);return}try{console.log("ðŸ“¤ Sending message to chat ID:",c.value.id);const i=await V.sendMessageToChat(c.value.id,o);return c.value&&(c.value.last_message=i,c.value.unread_count=0),i}catch(i){throw b.value=i instanceof Error?i.message:"Failed to send message",console.error("Send message error:",i),i}},O=async(o,i,n="user")=>{try{const l=await V.sendMessageToUser(o,i,n);return v.value.find(C=>C.id===l.chat.id)||v.value.unshift(l.chat),c.value=l.chat,l}catch(l){throw b.value=l instanceof Error?l.message:"Failed to send message",console.error("Send message to user error:",l),l}},p=async o=>{console.log("ðŸŽ¯ selectChat called with:",o),console.log("ðŸŽ¯ Chat ID:",o.id),c.value={...o},console.log("ðŸŽ¯ CurrentChat set:",c.value),await W(o.id),await Y(o.id)},$=o=>V.getChatDisplayName(o),U=o=>V.formatMessage(o),L=o=>{var i;return o.sender_id===((i=P.value)==null?void 0:i.id)},I=K(()=>v.value.filter(o=>o.unread_count>0)),z=K(()=>v.value.reduce((o,i)=>o+i.unread_count,0)),j=K(()=>{console.log("ðŸŽ¨ formattedMessages computed chamada"),console.log("ðŸŽ¨ messages.value:",u.value),console.log("ðŸŽ¨ messages.value.length:",u.value.length);const o=u.value.map(i=>U(i));return console.log("ðŸŽ¨ formatted result:",o),o}),H=()=>{try{console.log("ðŸ”” setupPusherListener started");const{$pusher:o}=ce();if(console.log("ðŸ”” Pusher obtained:",o),!o){console.warn("âš ï¸ Pusher not available for listener");return}console.log("ðŸ”” Configuring Pusher listener for new messages...");const i=ye().user.value;console.log("ðŸ”” Current user:",i),i!=null&&i.id?(console.log("ðŸ”” Available chats to configure listener:",v.value),v.value.forEach(n=>{const l=be.CHAT(n.id);console.log("ðŸ”” Configuring listener for channel:",l);try{if(o.channel(l)){console.log(`ðŸ”” Already subscribed to channel ${l}, skipping...`);return}const h=o.subscribe(l);console.log("ðŸ”” Channel subscribed:",h),h.bind(we.MESSAGE_SENT,C=>{var e;console.log("ðŸ”” Nova mensagem recebida via Pusher:",C);let T=C.created_at;try{if(T){const x=new Date(T);isNaN(x.getTime())&&(console.warn("âš ï¸ Data invÃ¡lida recebida do Pusher:",T),T=new Date().toISOString())}}catch(x){console.warn("âš ï¸ Erro ao processar data do Pusher:",x),T=new Date().toISOString()}const M={id:C.id,chat_id:C.chat_id,content:C.content,sender_id:C.sender_id,sender_type:C.sender_type,message_type:"text",metadata:null,is_read:C.is_read,read_at:null,created_at:T,updated_at:T};u.value.push(M),console.log("ðŸ”” Mensagem adicionada ao estado:",M);const g=v.value.findIndex(x=>x.id===C.chat_id);g!==-1&&(v.value[g].last_message=M,v.value[g].unread_count=(v.value[g].unread_count||0)+1,console.log("ðŸ”” Chat atualizado com nova mensagem")),((e=c.value)==null?void 0:e.id)===C.chat_id&&window.dispatchEvent(new CustomEvent("scroll-to-bottom"))}),console.log(`âœ… Listener configured for chat ${n.id} on channel ${l}`)}catch(h){console.error(`âŒ Error configuring listener for chat ${n.id}:`,h)}})):console.warn("âš ï¸ User not authenticated, cannot configure listener"),console.log("âœ… Listener do Pusher configurado com sucesso")}catch(o){console.error("âŒ Error configuring Pusher listener:",o)}},Y=async o=>{try{console.log(`ðŸ”” setupPusherListenerForChat started for chat ID: ${o}`);const{$pusher:i}=ce();if(!i){console.warn("âš ï¸ Pusher not available for specific chat listener");return}const n=be.CHAT(o);console.log("ðŸ”” Configuring listener for channel:",n);const l=i.subscribe(n);console.log("ðŸ”” Canal inscrito:",l),l.bind(we.MESSAGE_SENT,h=>{var g;console.log("ðŸ”” Nova mensagem recebida via Pusher para chat:",o,h);let C=h.created_at;try{if(C){const e=new Date(C);isNaN(e.getTime())&&(console.warn("âš ï¸ Data invÃ¡lida recebida do Pusher para chat:",o,C),C=new Date().toISOString())}}catch(e){console.warn("âš ï¸ Erro ao processar data do Pusher para chat:",o,e),C=new Date().toISOString()}const T={id:h.id,chat_id:h.chat_id,content:h.content,sender_id:h.sender_id,sender_type:h.sender_type,message_type:"text",metadata:null,is_read:h.is_read,read_at:null,created_at:C,updated_at:C};u.value.push(T),console.log("ðŸ”” Mensagem adicionada ao estado para chat:",o,T);const M=v.value.findIndex(e=>e.id===h.chat_id);M!==-1&&(v.value[M].last_message=T,v.value[M].unread_count=(v.value[M].unread_count||0)+1,console.log("ðŸ”” Chat atualizado com nova mensagem para chat:",o)),((g=c.value)==null?void 0:g.id)===h.chat_id&&window.dispatchEvent(new CustomEvent("scroll-to-bottom"))}),console.log(`âœ… Pusher listener successfully configured for chat ${o}`)}catch(i){console.error(`âŒ Error configuring Pusher listener for chat ${o}:`,i)}},se=()=>{try{console.log("ðŸ§ª Testing Pusher connection...");const{$pusher:o}=ce();if(!o){console.error("âŒ Pusher not available for test");return}const i=o.subscribe("test-channel");i.bind("pusher:subscription_succeeded",()=>{console.log("âœ… Connected to test channel"),console.log("âœ… Connection ID:",o.connection.connection.id)}),i.bind("pusher:subscription_error",n=>{console.error("âŒ Subscription error:",n)}),console.log("ðŸ§ª Connection test started")}catch(o){console.error("âŒ Connection test error:",o)}},Q=()=>{try{const{$pusher:o}=ce();o&&(console.log("ðŸ”” Cleaning up Pusher listener..."),o.disconnect())}catch(o){console.error("âŒ Error cleaning up Pusher listener:",o)}};return _e(()=>{console.log("ðŸš€ useChatManager - onMounted called"),console.log("ðŸš€ Available chats:",v.value),console.log("ðŸš€ Current user:",P.value),setTimeout(()=>{console.log("ðŸš€ Executing setupPusherListener after delay"),H()},1e3)}),Ue(()=>{Q()}),{chats:G(v),currentChat:G(c),messages:G(u),loading:G(D),error:G(b),pagination:G(A),unreadChats:I,totalUnread:z,formattedMessages:j,currentUser:P,loadChats:R,startChatWithUser:B,loadChatMessages:W,sendMessage:F,sendMessageToUser:O,selectChat:p,getChatDisplayName:$,formatMessage:U,isOwnMessage:L,testPusherConnection:se,setupPusherListenerForChat:Y}},Le={class:"chat-interface"},ze={class:"chat-header"},Ie={class:"d-flex align-center justify-space-between w-100"},Re={class:"d-flex align-center"},Fe={class:"text-h6"},Oe={key:0,class:"text-caption text-grey"},He={key:1,class:"text-caption text-grey"},Be={class:"d-flex align-center"},Ge={key:0,class:"conversations-list"},je={key:0,class:"text-center pa-4"},Ke={key:1,class:"pa-4"},We={key:2,class:"text-center pa-8"},Ye={key:3,class:"chats"},qe=["onClick"],Je={class:"conversation-avatar"},Qe={class:"conversation-content"},Xe={class:"conversation-header"},Ze={class:"text-subtitle-1 font-weight-medium"},et={class:"text-caption text-grey"},tt={class:"text-body-2 text-grey conversation-preview"},at={key:1,class:"chat-main"},st={key:0,class:"text-center pa-4"},lt={key:1,class:"pa-4"},ot={key:2,class:"text-center pa-8"},nt={class:"text-body-2 text-grey"},rt={key:3,class:"messages-list"},it={class:"message-content"},ct={class:"message-header"},ut={class:"message-author"},dt={class:"message-time"},mt={class:"message-text"},vt={class:"chat-input"},gt={key:0,class:"send-error mb-2"},ft={class:"d-flex align-end"},pt=Ee({__name:"ChatInterface",props:{initialUser:{default:null},initialChat:{default:null}},emits:["close"],setup(v,{emit:c}){const u=v,D=c,b=S(""),A=S(),P=S(""),{chats:J,currentChat:k,messages:V,loading:R,error:B,formattedMessages:W,loadChats:F,loadChatMessages:O,selectChat:p,sendMessage:$,startChatWithUser:U,getChatDisplayName:L,testPusherConnection:I}=Ve(),z=K(()=>k.value?L(k.value):u.initialUser?`Chat com ${u.initialUser.name}`:"Chat"),j=()=>{D("close")},H=async()=>{if(b.value.trim()){console.log("ðŸ’¬ handleSendMessage chamado:",{currentChat:k.value,initialUser:u.initialUser,message:b.value});try{if(P.value="",k.value)console.log("ðŸ’¬ Enviando mensagem para chat existente:",k.value.id),await $(b.value),b.value="";else if(u.initialUser){console.log("ðŸ’¬ Criando novo chat com usuÃ¡rio:",u.initialUser.id);const n=await U(u.initialUser.id,"user");n&&n.id&&(await ue(),await $(b.value),b.value="")}}catch(n){console.error("Erro ao enviar mensagem:",n),P.value="Erro ao enviar mensagem. Tente novamente.",setTimeout(()=>{P.value=""},3e3)}}},Y=async()=>{if(u.initialUser&&!k.value)try{console.log("ðŸš€ Iniciando chat com usuÃ¡rio:",u.initialUser);const n=await U(u.initialUser.id,"user");n&&n.id&&(console.log("ðŸ“¥ Carregando mensagens do chat criado:",n.id),await ue(),await O(n.id))}catch(n){console.error("Erro ao inicializar chat:",n),P.value="Erro ao inicializar chat. Tente novamente.",setTimeout(()=>{P.value=""},5e3)}},se=()=>{},Q=()=>{ue(()=>{A.value&&(A.value.scrollTop=A.value.scrollHeight)})},o=n=>{if(!n)return"--:--";try{const l=new Date(n);return isNaN(l.getTime())?"--:--":l.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}catch(l){return console.warn("Erro ao formatar data:",l,n),"--:--"}},i=n=>n.isOwn?"VocÃª":n.user_name||"UsuÃ¡rio";return _e(async()=>{u.initialUser||await F(),await Y(),window.addEventListener("scroll-to-bottom",Q)}),Ue(()=>{window.removeEventListener("scroll-to-bottom",Q)}),pe(()=>u.initialChat,n=>{n&&p(n)},{immediate:!0}),pe(()=>u.initialUser,async n=>{if(n&&!k.value)try{await Y()}catch(l){console.error("Erro ao inicializar chat com usuÃ¡rio:",l),P.value="Erro ao inicializar chat. Tente novamente.",setTimeout(()=>{P.value=""},5e3)}},{immediate:!0}),pe(k,()=>{k.value&&ue(()=>{Q()})}),console.log("ðŸŽ¯ ChatInterface carregado com initialChat:",u.initialChat,"initialUser:",u.initialUser),(n,l)=>{const h=w("v-icon"),C=w("v-btn"),T=w("v-progress-circular"),M=w("v-alert"),g=w("v-avatar"),e=w("v-badge"),x=w("v-text-field"),N=w("v-form");return _(),E("div",Le,[s("div",ze,[s("div",Ie,[s("div",Re,[m(k)?(_(),ee(C,{key:0,onClick:j,icon:"",size:"small",variant:"text",class:"mr-2"},{default:a(()=>[t(h,null,{default:a(()=>l[2]||(l[2]=[d("mdi-arrow-left")])),_:1})]),_:1})):ae("",!0),t(h,{color:"primary",class:"mr-2"},{default:a(()=>l[3]||(l[3]=[d("mdi-chat")])),_:1}),s("div",null,[s("h3",Fe,f(z.value),1),m(k)?(_(),E("p",Oe,f(m(k).type==="private"?"Chat privado":"Chat em grupo"),1)):n.initialUser?(_(),E("p",He,f(n.initialUser.email),1)):ae("",!0)])]),s("div",Be,[t(C,{onClick:m(I),icon:"",size:"small",variant:"text",class:"mr-2",title:"Testar conexÃ£o Pusher"},{default:a(()=>[t(h,null,{default:a(()=>l[4]||(l[4]=[d("mdi-wifi")])),_:1})]),_:1},8,["onClick"]),t(C,{onClick:l[0]||(l[0]=y=>n.$emit("close")),icon:"",size:"small",variant:"text"},{default:a(()=>[t(h,null,{default:a(()=>l[5]||(l[5]=[d("mdi-close")])),_:1})]),_:1})])])]),!m(k)&&!n.initialUser?(_(),E("div",Ge,[m(R)?(_(),E("div",je,[t(T,{indeterminate:"",color:"primary"})])):m(B)?(_(),E("div",Ke,[t(M,{type:"error",variant:"tonal"},{default:a(()=>[d(f(m(B)),1)]),_:1})])):m(J).length===0?(_(),E("div",We,[t(h,{size:"64",color:"grey",class:"mb-4"},{default:a(()=>l[6]||(l[6]=[d("mdi-chat-outline")])),_:1}),l[7]||(l[7]=s("h3",{class:"text-h6 mb-2"},"Nenhum chat",-1)),l[8]||(l[8]=s("p",{class:"text-body-2 text-grey"}," Inicie um chat com um usuÃ¡rio para comeÃ§ar a conversar. ",-1))])):(_(),E("div",Ye,[(_(!0),E(me,null,ve(m(J),y=>{var le,X,te;return _(),E("div",{key:y.id,onClick:he=>m(p)(y),class:xe(["conversation-item",{active:((le=m(k))==null?void 0:le.id)===y.id}])},[s("div",Je,[t(g,{size:"48",color:"primary"},{default:a(()=>[t(h,null,{default:a(()=>l[9]||(l[9]=[d("mdi-account")])),_:1})]),_:1}),y.unread_count>0?(_(),ee(e,{key:0,content:y.unread_count,color:"error",dot:"",class:"conversation-badge"},null,8,["content"])):ae("",!0)]),s("div",Qe,[s("div",Xe,[s("h4",Ze,f(m(L)(y)),1),s("span",et,f(o((X=y.last_message)==null?void 0:X.created_at)),1)]),s("p",tt,f(((te=y.last_message)==null?void 0:te.content)||"Nenhuma mensagem ainda"),1)])],10,qe)}),128))]))])):(_(),E("div",at,[s("div",{ref_key:"messagesContainer",ref:A,class:"chat-messages",onScroll:se},[m(R)?(_(),E("div",st,[t(T,{indeterminate:"",color:"primary"})])):m(B)?(_(),E("div",lt,[t(M,{type:"error",variant:"tonal"},{default:a(()=>[d(f(m(B)),1)]),_:1})])):m(V).length===0?(_(),E("div",ot,[t(h,{size:"64",color:"grey",class:"mb-4"},{default:a(()=>l[10]||(l[10]=[d("mdi-message-outline")])),_:1}),l[11]||(l[11]=s("h3",{class:"text-h6 mb-2"},"Nenhuma mensagem",-1)),s("p",nt,f(n.initialUser?`Inicie um chat com ${n.initialUser.name}!`:"Seja o primeiro a enviar uma mensagem!"),1)])):(_(),E("div",rt,[(_(!0),E(me,null,ve(m(W),y=>(_(),E("div",{key:y.id,class:xe(["message-item",{"message-own":y.isOwn}])},[s("div",it,[s("div",ct,[s("span",ut,f(i(y)),1),s("span",dt,f(y.time),1)]),s("div",mt,f(y.content),1)])],2))),128))]))],544),s("div",vt,[P.value?(_(),E("div",gt,[t(M,{type:"error",variant:"tonal",density:"compact"},{default:a(()=>[d(f(P.value),1)]),_:1})])):ae("",!0),t(N,{onSubmit:Ae(H,["prevent"])},{default:a(()=>[s("div",ft,[t(x,{modelValue:b.value,"onUpdate:modelValue":l[1]||(l[1]=y=>b.value=y),onKeydown:Te(H,["enter"]),placeholder:n.initialUser?`Digite uma mensagem para ${n.initialUser.name}...`:"Digite sua mensagem...",variant:"outlined",density:"compact","hide-details":"",class:"flex-grow-1 mr-2",disabled:m(R)},null,8,["modelValue","placeholder","disabled"]),t(C,{onClick:H,color:"primary",icon:"",disabled:!b.value.trim()||m(R)},{default:a(()=>[t(h,null,{default:a(()=>l[12]||(l[12]=[d("mdi-send")])),_:1})]),_:1},8,["disabled"])])]),_:1})])]))])}}}),_t=Se(pt,[["__scopeId","data-v-72bf487a"]]),ht=()=>{const v=S([]),c=S(null),u=S(!1),D=S(null),b=new Me,A=async(p=1,$=15)=>{u.value=!0,D.value=null;try{const U=await b.getUsers(p,$);U.success&&U.data?(v.value=U.data.users,c.value=U.data.pagination):D.value=U.error||"Failed to load users"}catch{D.value="Unexpected error loading users"}finally{u.value=!1}},P=()=>{c.value&&c.value.current_page<c.value.last_page&&A(c.value.current_page+1,c.value.per_page)},J=()=>{c.value&&c.value.current_page>1&&A(c.value.current_page-1,c.value.per_page)},k=p=>{c.value&&p>=1&&p<=c.value.last_page&&A(p,c.value.per_page)},V=p=>{A(1,p)},R=p=>({...p,role:"User",status:p.email_verified_at?"Ativo":"Pendente",statusColor:p.email_verified_at?"success":"warning",avatar:`/images/profile/user-${p.id%8+1}.jpg`,phone:`+55 (11) ${String(p.id).padStart(5,"0")}-${String(p.id).padStart(4,"0")}`,department:"TI",lastLogin:p.email_verified_at?p.updated_at:"Nunca"}),B=K(()=>v.value.map(R)),W=K(()=>c.value&&c.value.current_page<c.value.last_page),F=K(()=>c.value&&c.value.current_page>1),O=K(()=>{if(!c.value)return[];const p=[],$=c.value.current_page,U=c.value.last_page;let L=Math.max(1,$-2),I=Math.min(U,$+2);$<=3?I=Math.min(U,5):$>=U-2&&(L=Math.max(1,U-4));for(let z=L;z<=I;z++)p.push(z);return p});return{users:G(v),pagination:G(c),loading:G(u),error:G(D),formattedUsers:B,canGoNext:W,canGoPrev:F,pageNumbers:O,loadUsers:A,nextPage:P,prevPage:J,goToPage:k,changePerPage:V,formatUserForDisplay:R}},Ct={class:"d-flex align-center justify-space-between"},yt={class:"d-flex gap-2"},xt={class:"d-flex justify-center align-center py-8"},wt={class:"d-flex align-center"},bt=["src","alt"],Ut={class:"font-weight-medium"},Et={class:"text-caption text-medium-emphasis"},St={class:"d-flex justify-center gap-1"},kt={key:0,class:"d-flex align-center justify-space-between mt-4"},Pt={class:"text-body-2 text-medium-emphasis"},$t={class:"d-flex align-center gap-2"},Dt={class:"d-flex gap-1"},At={class:"text-body-2"},Tt={class:"d-flex align-center gap-3"},Mt={class:"text-h6"},Nt={class:"text-caption text-medium-emphasis"},Vt=Ee({__name:"index",setup(v){const{formattedUsers:c,pagination:u,loading:D,error:b,loadUsers:A,nextPage:P,prevPage:J,goToPage:k,changePerPage:V,canGoNext:R,canGoPrev:B,pageNumbers:W}=ht(),F=S(""),O=S("all"),p=S("all"),$=S("all"),U=S(!1),L=S(!1),I=S(!1),z=S(null),j=S(!1),H=S(null),Y=[{value:"all",label:"All Status"},{value:"Ativo",label:"Active"},{value:"Pendente",label:"Pending"}],se=[{value:"all",label:"All Roles"},{value:"User",label:"User"}],Q=[{value:"all",label:"All Departments"},{value:"TI",label:"IT"}],o=K(()=>c.value.filter(g=>{const e=g.name.toLowerCase().includes(F.value.toLowerCase())||g.email.toLowerCase().includes(F.value.toLowerCase()),x=O.value==="all"||g.status===O.value,N=p.value==="all"||g.role===p.value,y=$.value==="all"||g.department===$.value;return e&&x&&N&&y})),i=()=>{U.value=!0},n=g=>{z.value={...g},L.value=!0},l=g=>{z.value=g,I.value=!0},h=()=>{var g,e;z.value&&(I.value=!1,z.value=null,A(((g=u.value)==null?void 0:g.current_page)||1,((e=u.value)==null?void 0:e.per_page)||15))},C=g=>{g.status==="Active"?(g.status="Pending",g.statusColor="warning"):(g.status="Active",g.statusColor="success")},T=async g=>{console.log("Starting chat with user:",g),H.value=g,j.value=!0},M=()=>{F.value="",O.value="all",p.value="all",$.value="all"};return _e(()=>{A()}),(g,e)=>{const x=w("v-btn"),N=w("v-col"),y=w("v-row"),le=w("v-text-field"),X=w("v-select"),te=w("v-chip"),he=w("v-progress-circular"),ke=w("v-alert"),Ce=w("v-avatar"),q=w("v-icon"),Pe=w("v-table"),oe=w("v-card-title"),ne=w("v-card-text"),ge=w("v-spacer"),fe=w("v-card-actions"),re=w("v-card"),ie=w("v-dialog"),$e=_t;return _(),E("div",null,[t(y,{class:"mb-4"},{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[s("div",Ct,[e[16]||(e[16]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold"},"Users"),s("p",{class:"text-body-1 text-medium-emphasis"}," Manage all system users ")],-1)),t(x,{color:"primary","prepend-icon":"mdi-plus",onClick:i,size:"large"},{default:a(()=>e[15]||(e[15]=[d(" Add User ")])),_:1})])]),_:1})]),_:1}),t(y,{class:"mb-6"},{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(de,{title:"Filters"},{default:a(()=>[t(y,null,{default:a(()=>[t(N,{cols:"12",md:"3"},{default:a(()=>[t(le,{modelValue:F.value,"onUpdate:modelValue":e[0]||(e[0]=r=>F.value=r),label:"Search by name or email","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),t(N,{cols:"12",md:"3"},{default:a(()=>[t(X,{modelValue:O.value,"onUpdate:modelValue":e[1]||(e[1]=r=>O.value=r),items:Y,"item-title":"label","item-value":"value",label:"Status",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(N,{cols:"12",md:"3"},{default:a(()=>[t(X,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=r=>p.value=r),items:se,"item-title":"label","item-value":"value",label:"Role",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(N,{cols:"12",md:"3"},{default:a(()=>[t(X,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=r=>$.value=r),items:Q,"item-title":"label","item-value":"value",label:"Department",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[s("div",yt,[t(x,{variant:"outlined",onClick:M,"prepend-icon":"mdi-refresh"},{default:a(()=>e[17]||(e[17]=[d(" Clear Filters ")])),_:1}),t(te,{color:"primary",variant:"tonal",class:"ml-auto"},{default:a(()=>[d(f(o.value.length)+" users found ",1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),m(D)?(_(),ee(y,{key:0},{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(de,null,{default:a(()=>[s("div",xt,[t(he,{indeterminate:"",color:"primary",size:"64"})])]),_:1})]),_:1})]),_:1})):m(b)?(_(),ee(y,{key:1},{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(de,null,{default:a(()=>[t(ke,{type:"error",variant:"tonal",class:"mb-0"},{default:a(()=>[d(f(m(b)),1)]),_:1})]),_:1})]),_:1})]),_:1})):(_(),ee(y,{key:2},{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(de,{title:"Users List"},{default:a(()=>[t(Pe,{"fixed-header":"",height:"600px"},{default:a(()=>[e[21]||(e[21]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"User"),s("th",{class:"text-left"},"Email"),s("th",{class:"text-left"},"Role"),s("th",{class:"text-left"},"Department"),s("th",{class:"text-left"},"Status"),s("th",{class:"text-left"},"Last Login"),s("th",{class:"text-left"},"Created At"),s("th",{class:"text-center"},"Actions")])],-1)),s("tbody",null,[(_(!0),E(me,null,ve(o.value,r=>(_(),E("tr",{key:r.id},[s("td",null,[s("div",wt,[t(Ce,{size:"40",class:"mr-3"},{default:a(()=>[s("img",{src:r.avatar,alt:r.name},null,8,bt)]),_:2},1024),s("div",null,[s("div",Ut,f(r.name),1),s("div",Et,f(r.phone),1)])])]),s("td",null,f(r.email),1),s("td",null,[t(te,{color:r.role==="Admin"?"error":r.role==="Manager"?"warning":r.role==="Editor"?"info":"default",variant:"tonal",size:"small"},{default:a(()=>[d(f(r.role),1)]),_:2},1032,["color"])]),s("td",null,f(r.department),1),s("td",null,[t(te,{color:r.statusColor,variant:"tonal",size:"small"},{default:a(()=>[d(f(r.status),1)]),_:2},1032,["color"])]),s("td",null,f(r.lastLogin),1),s("td",null,f(new Date(r.created_at).toLocaleDateString("pt-BR")),1),s("td",null,[s("div",St,[t(x,{icon:"",size:"small",variant:"text",color:"info",onClick:Z=>T(r),title:"Start Chat"},{default:a(()=>[t(q,null,{default:a(()=>e[18]||(e[18]=[d("mdi-chat")])),_:1})]),_:2},1032,["onClick"]),t(x,{icon:"",size:"small",variant:"text",color:"primary",onClick:Z=>n(r),title:"Edit"},{default:a(()=>[t(q,null,{default:a(()=>e[19]||(e[19]=[d("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),t(x,{icon:"",size:"small",variant:"text",color:r.status==="Active"?"warning":"success",onClick:Z=>C(r),title:r.status==="Active"?"Deactivate":"Activate"},{default:a(()=>[t(q,null,{default:a(()=>[d(f(r.status==="Active"?"mdi-account-off":"mdi-account-check"),1)]),_:2},1024)]),_:2},1032,["color","onClick","title"]),t(x,{icon:"",size:"small",variant:"text",color:"error",onClick:Z=>l(r),title:"Delete"},{default:a(()=>[t(q,null,{default:a(()=>e[20]||(e[20]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick"])])])]))),128))])]),_:1}),m(u)?(_(),E("div",kt,[s("div",Pt," Showing "+f(m(u).from)+" to "+f(m(u).to)+" of "+f(m(u).total)+" users ",1),s("div",$t,[t(X,{"model-value":m(u).per_page,"onUpdate:modelValue":m(V),items:[10,15,25,50],variant:"outlined",density:"compact","hide-details":"",style:{width:"80px"}},null,8,["model-value","onUpdate:modelValue"]),t(x,{icon:"",variant:"text",disabled:!m(B),onClick:m(J),title:"Previous page"},{default:a(()=>[t(q,null,{default:a(()=>e[22]||(e[22]=[d("mdi-chevron-left")])),_:1})]),_:1},8,["disabled","onClick"]),s("div",Dt,[(_(!0),E(me,null,ve(m(W),r=>(_(),ee(x,{key:r,color:r===m(u).current_page?"primary":void 0,variant:"text",size:"small",onClick:Z=>m(k)(r)},{default:a(()=>[d(f(r),1)]),_:2},1032,["color","onClick"]))),128))]),t(x,{icon:"",variant:"text",disabled:!m(R),onClick:m(P),title:"Next page"},{default:a(()=>[t(q,null,{default:a(()=>e[23]||(e[23]=[d("mdi-chevron-right")])),_:1})]),_:1},8,["disabled","onClick"])])])):ae("",!0)]),_:1})]),_:1})]),_:1})),t(ie,{modelValue:U.value,"onUpdate:modelValue":e[6]||(e[6]=r=>U.value=r),"max-width":"600px"},{default:a(()=>[t(re,null,{default:a(()=>[t(oe,{class:"text-h5"},{default:a(()=>e[24]||(e[24]=[d(" Add New User ")])),_:1}),t(ne,null,{default:a(()=>e[25]||(e[25]=[s("p",{class:"text-body-2 text-medium-emphasis"}," User addition form will be implemented here. ",-1)])),_:1}),t(fe,null,{default:a(()=>[t(ge),t(x,{color:"grey-darken-1",variant:"text",onClick:e[4]||(e[4]=r=>U.value=!1)},{default:a(()=>e[26]||(e[26]=[d(" Cancel ")])),_:1}),t(x,{color:"primary",onClick:e[5]||(e[5]=r=>U.value=!1)},{default:a(()=>e[27]||(e[27]=[d(" Add ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ie,{modelValue:L.value,"onUpdate:modelValue":e[9]||(e[9]=r=>L.value=r),"max-width":"600px"},{default:a(()=>[t(re,null,{default:a(()=>[t(oe,{class:"text-h5"},{default:a(()=>e[28]||(e[28]=[d(" Edit User ")])),_:1}),t(ne,null,{default:a(()=>e[29]||(e[29]=[s("p",{class:"text-body-2 text-medium-emphasis"}," Edit form will be implemented here. ",-1)])),_:1}),t(fe,null,{default:a(()=>[t(ge),t(x,{color:"grey-darken-1",variant:"text",onClick:e[7]||(e[7]=r=>L.value=!1)},{default:a(()=>e[30]||(e[30]=[d(" Cancel ")])),_:1}),t(x,{color:"primary",onClick:e[8]||(e[8]=r=>L.value=!1)},{default:a(()=>e[31]||(e[31]=[d(" Save ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ie,{modelValue:I.value,"onUpdate:modelValue":e[11]||(e[11]=r=>I.value=r),"max-width":"400px"},{default:a(()=>[t(re,null,{default:a(()=>[t(oe,{class:"text-h5"},{default:a(()=>e[32]||(e[32]=[d(" Confirm Deletion ")])),_:1}),t(ne,null,{default:a(()=>{var r;return[s("p",At,[e[33]||(e[33]=d(" Are you sure you want to delete the user ")),s("strong",null,f((r=z.value)==null?void 0:r.name),1),e[34]||(e[34]=d("? "))]),e[35]||(e[35]=s("p",{class:"text-caption text-medium-emphasis"}," This action cannot be undone. ",-1))]}),_:1}),t(fe,null,{default:a(()=>[t(ge),t(x,{color:"grey-darken-1",variant:"text",onClick:e[10]||(e[10]=r=>I.value=!1)},{default:a(()=>e[36]||(e[36]=[d(" Cancel ")])),_:1}),t(x,{color:"error",onClick:h},{default:a(()=>e[37]||(e[37]=[d(" Delete ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ie,{modelValue:j.value,"onUpdate:modelValue":e[14]||(e[14]=r=>j.value=r),"max-width":"800px",persistent:""},{default:a(()=>[t(re,{class:"chat-dialog-card"},{default:a(()=>[t(oe,{class:"d-flex align-center justify-space-between pa-4"},{default:a(()=>{var r,Z;return[s("div",Tt,[t(Ce,{size:"40",color:"primary"},{default:a(()=>[t(q,null,{default:a(()=>e[38]||(e[38]=[d("mdi-account")])),_:1})]),_:1}),s("div",null,[s("div",Mt,"Chat with "+f((r=H.value)==null?void 0:r.name),1),s("div",Nt,f((Z=H.value)==null?void 0:Z.email),1)])]),t(x,{icon:"",variant:"text",onClick:e[12]||(e[12]=Lt=>j.value=!1),title:"Close"},{default:a(()=>[t(q,null,{default:a(()=>e[39]||(e[39]=[d("mdi-close")])),_:1})]),_:1})]}),_:1}),t(ne,{class:"chat-dialog-content pa-0"},{default:a(()=>[H.value?(_(),ee($e,{key:0,"initial-chat":null,"initial-user":H.value,onClose:e[13]||(e[13]=r=>j.value=!1)},null,8,["initial-user"])):ae("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Ft=Se(Vt,[["__scopeId","data-v-d7858c6b"]]);export{Ft as default};
