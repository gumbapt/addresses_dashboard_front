import{e as U,u as ye,l as W,o as fe,x as Ue,s as K,y as de,d as Ee,z as _e,c as b,g as o,h as ee,i as oe,a as e,q as m,r as x,w as t,j as c,t as f,F as me,m as ve,k as $e,B as De,C as ue,b as C,D as xe,_ as ke,A as Me}from"./CLCxtK2z.js";import{C as Ae}from"./DAUD4oqb.js";import{_ as ce}from"./BAqccLgu.js";const we={MESSAGE_SENT:"MessageSent",MESSAGE_READ:"MessageRead",MESSAGE_DELETED:"MessageDeleted",CHAT_CREATED:"ChatCreated",CHAT_UPDATED:"ChatUpdated",CHAT_DELETED:"ChatDeleted",USER_ONLINE:"UserOnline",USER_OFFLINE:"UserOffline",USER_TYPING:"UserTyping",USER_STOPPED_TYPING:"UserStoppedTyping"},be={CHAT:v=>`chat.${v}`,PRIVATE_USER:v=>`private-user.${v}`,PRIVATE_CHAT:v=>`private-chat.${v}`,PUBLIC_CHAT:v=>`public-chat.${v}`,PUBLIC_USERS:"public-users"},Ne=()=>{const v=U([]),d=U(null),u=U([]),D=U(!1),w=U(null),M=U(null),T=ye().user,N=new Ae,S=async(s=1)=>{D.value=!0,w.value=null;try{const i=await N.getChats(s);console.log(i),v.value=i.chats||[],M.value=i.pagination}catch(i){w.value=i instanceof Error?i.message:"Failed to load chats",console.error("Load chats error:",i)}finally{D.value=!1}},J=async(s,i="user")=>{D.value=!0,w.value=null;try{const g=await N.createPrivateChat(s,i);if(console.log("ðŸš€ Chat criado:",g),!g||!g.id)throw new Error("Chat created without valid ID");return v.value.find(r=>r.id===g.id)||v.value.unshift(g),d.value=g,console.log("ðŸŽ¯ CurrentChat definido:",d.value),await B(g.id),g}catch(g){throw w.value=g instanceof Error?g.message:"Failed to start chat",console.error("Start chat error:",g),g}finally{D.value=!1}},R=async(s,i=1)=>{var g;console.log("ðŸ“¥ loadChatMessages chamado para chat ID:",s),D.value=!0,w.value=null;try{const p=await N.getChatMessages(s,i);console.log("ðŸ“¥ Resposta do getChatMessages:",p),console.log("ðŸ“¥ Messages array:",p.messages),console.log("ðŸ“¥ Messages length:",(g=p.messages)==null?void 0:g.length),i===1?(u.value=p.messages,console.log("ðŸ“¥ Messages definidos:",u.value)):u.value.unshift(...p.messages)}catch(p){w.value=p instanceof Error?p.message:"Failed to load messages",console.error("Load chat messages error:",p)}finally{D.value=!1}},q=async s=>{if(console.log("ðŸ“¤ Tentando enviar mensagem:",{currentChat:d.value,content:s}),!d.value||!d.value.id||!s.trim()){console.error("Send message error: currentChat or chat ID is undefined",d.value);return}try{console.log("ðŸ“¤ Enviando mensagem para chat ID:",d.value.id);const i=await N.sendMessageToChat(d.value.id,s);return d.value&&(d.value.last_message=i,d.value.unread_count=0),i}catch(i){throw w.value=i instanceof Error?i.message:"Failed to send message",console.error("Send message error:",i),i}},Q=async(s,i,g="user")=>{try{const p=await N.sendMessageToUser(s,i,g);return v.value.find(l=>l.id===p.chat.id)||v.value.unshift(p.chat),d.value=p.chat,p}catch(p){throw w.value=p instanceof Error?p.message:"Failed to send message",console.error("Send message to user error:",p),p}},G=async s=>{console.log("ðŸŽ¯ selectChat chamado com:",s),console.log("ðŸŽ¯ Chat ID:",s.id),d.value={...s},console.log("ðŸŽ¯ CurrentChat definido:",d.value),await R(s.id),await B(s.id)},H=s=>N.getChatDisplayName(s),_=s=>N.formatMessage(s),$=s=>{var i;return s.sender_id===((i=T.value)==null?void 0:i.id)},E=W(()=>v.value.filter(s=>s.unread_count>0)),z=W(()=>v.value.reduce((s,i)=>s+i.unread_count,0)),F=W(()=>{console.log("ðŸŽ¨ formattedMessages computed chamada"),console.log("ðŸŽ¨ messages.value:",u.value),console.log("ðŸŽ¨ messages.value.length:",u.value.length);const s=u.value.map(i=>_(i));return console.log("ðŸŽ¨ formatted result:",s),s}),I=()=>{try{console.log("ðŸ”” setupPusherListener iniciado");const{$pusher:s}=de();if(console.log("ðŸ”” Pusher obtido:",s),!s){console.warn("âš ï¸ Pusher nÃ£o disponÃ­vel para listener");return}console.log("ðŸ”” Configurando listener do Pusher para novas mensagens...");const i=ye().user.value;console.log("ðŸ”” UsuÃ¡rio atual:",i),i!=null&&i.id?(console.log("ðŸ”” Chats disponÃ­veis para configurar listener:",v.value),v.value.forEach(g=>{const p=be.CHAT(g.id);console.log("ðŸ”” Configurando listener para canal:",p);try{if(s.channel(p)){console.log(`ðŸ”” JÃ¡ inscrito no canal ${p}, pulando...`);return}const r=s.subscribe(p);console.log("ðŸ”” Canal inscrito:",r),r.bind(we.MESSAGE_SENT,l=>{var V;console.log("ðŸ”” Nova mensagem recebida via Pusher:",l);let k=l.created_at;try{if(k){const h=new Date(k);isNaN(h.getTime())&&(console.warn("âš ï¸ Data invÃ¡lida recebida do Pusher:",k),k=new Date().toISOString())}}catch(h){console.warn("âš ï¸ Erro ao processar data do Pusher:",h),k=new Date().toISOString()}const A={id:l.id,chat_id:l.chat_id,content:l.content,sender_id:l.sender_id,sender_type:l.sender_type,message_type:"text",metadata:null,is_read:l.is_read,read_at:null,created_at:k,updated_at:k};u.value.push(A),console.log("ðŸ”” Mensagem adicionada ao estado:",A);const O=v.value.findIndex(h=>h.id===l.chat_id);O!==-1&&(v.value[O].last_message=A,v.value[O].unread_count=(v.value[O].unread_count||0)+1,console.log("ðŸ”” Chat atualizado com nova mensagem")),((V=d.value)==null?void 0:V.id)===l.chat_id&&window.dispatchEvent(new CustomEvent("scroll-to-bottom"))}),console.log(`âœ… Listener configurado para chat ${g.id} no canal ${p}`)}catch(r){console.error(`âŒ Erro ao configurar listener para chat ${g.id}:`,r)}})):console.warn("âš ï¸ UsuÃ¡rio nÃ£o autenticado, nÃ£o Ã© possÃ­vel configurar listener"),console.log("âœ… Listener do Pusher configurado com sucesso")}catch(s){console.error("âŒ Erro ao configurar listener do Pusher:",s)}},B=async s=>{try{console.log(`ðŸ”” setupPusherListenerForChat iniciado para chat ID: ${s}`);const{$pusher:i}=de();if(!i){console.warn("âš ï¸ Pusher nÃ£o disponÃ­vel para listener de chat especÃ­fico");return}const g=be.CHAT(s);console.log("ðŸ”” Configurando listener para canal:",g);const p=i.subscribe(g);console.log("ðŸ”” Canal inscrito:",p),p.bind(we.MESSAGE_SENT,r=>{var O;console.log("ðŸ”” Nova mensagem recebida via Pusher para chat:",s,r);let l=r.created_at;try{if(l){const V=new Date(l);isNaN(V.getTime())&&(console.warn("âš ï¸ Data invÃ¡lida recebida do Pusher para chat:",s,l),l=new Date().toISOString())}}catch(V){console.warn("âš ï¸ Erro ao processar data do Pusher para chat:",s,V),l=new Date().toISOString()}const k={id:r.id,chat_id:r.chat_id,content:r.content,sender_id:r.sender_id,sender_type:r.sender_type,message_type:"text",metadata:null,is_read:r.is_read,read_at:null,created_at:l,updated_at:l};u.value.push(k),console.log("ðŸ”” Mensagem adicionada ao estado para chat:",s,k);const A=v.value.findIndex(V=>V.id===r.chat_id);A!==-1&&(v.value[A].last_message=k,v.value[A].unread_count=(v.value[A].unread_count||0)+1,console.log("ðŸ”” Chat atualizado com nova mensagem para chat:",s)),((O=d.value)==null?void 0:O.id)===r.chat_id&&window.dispatchEvent(new CustomEvent("scroll-to-bottom"))}),console.log(`âœ… Listener do Pusher configurado com sucesso para chat ${s}`)}catch(i){console.error(`âŒ Erro ao configurar listener do Pusher para chat ${s}:`,i)}},j=()=>{try{console.log("ðŸ§ª Testando conexÃ£o do Pusher...");const{$pusher:s}=de();if(!s){console.error("âŒ Pusher nÃ£o disponÃ­vel para teste");return}const i=s.subscribe("test-channel");i.bind("pusher:subscription_succeeded",()=>{console.log("âœ… Conectado ao canal de teste"),console.log("âœ… Connection ID:",s.connection.connection.id)}),i.bind("pusher:subscription_error",g=>{console.error("âŒ Erro na inscriÃ§Ã£o:",g)}),console.log("ðŸ§ª Teste de conexÃ£o iniciado")}catch(s){console.error("âŒ Erro no teste de conexÃ£o:",s)}},te=()=>{try{const{$pusher:s}=de();s&&(console.log("ðŸ”” Limpando listener do Pusher..."),s.disconnect())}catch(s){console.error("âŒ Erro ao limpar listener do Pusher:",s)}};return fe(()=>{console.log("ðŸš€ useChatManager - onMounted chamado"),console.log("ðŸš€ Chats disponÃ­veis:",v.value),console.log("ðŸš€ UsuÃ¡rio atual:",T.value),setTimeout(()=>{console.log("ðŸš€ Executando setupPusherListener apÃ³s delay"),I()},1e3)}),Ue(()=>{te()}),{chats:K(v),currentChat:K(d),messages:K(u),loading:K(D),error:K(w),pagination:K(M),unreadChats:E,totalUnread:z,formattedMessages:F,currentUser:T,loadChats:S,startChatWithUser:J,loadChatMessages:R,sendMessage:q,sendMessageToUser:Q,selectChat:G,getChatDisplayName:H,formatMessage:_,isOwnMessage:$,testPusherConnection:j,setupPusherListenerForChat:B}},Ve={class:"chat-interface"},Le={class:"chat-header"},ze={class:"d-flex align-center justify-space-between w-100"},Ie={class:"d-flex align-center"},Re={class:"text-h6"},Fe={key:0,class:"text-caption text-grey"},Oe={key:1,class:"text-caption text-grey"},Ge={class:"d-flex align-center"},He={key:0,class:"conversations-list"},Be={key:0,class:"text-center pa-4"},je={key:1,class:"pa-4"},qe={key:2,class:"text-center pa-8"},Ke={key:3,class:"chats"},We=["onClick"],Ye={class:"conversation-avatar"},Je={class:"conversation-content"},Qe={class:"conversation-header"},Xe={class:"text-subtitle-1 font-weight-medium"},Ze={class:"text-caption text-grey"},et={class:"text-body-2 text-grey conversation-preview"},tt={key:1,class:"chat-main"},at={key:0,class:"text-center pa-4"},ot={key:1,class:"pa-4"},st={key:2,class:"text-center pa-8"},lt={class:"text-body-2 text-grey"},nt={key:3,class:"messages-list"},rt={class:"message-content"},it={class:"message-header"},dt={class:"message-author"},ut={class:"message-time"},ct={class:"message-text"},mt={class:"chat-input"},vt={key:0,class:"send-error mb-2"},pt={class:"d-flex align-end"},gt=Ee({__name:"ChatInterface",props:{initialUser:{default:null},initialChat:{default:null}},emits:["close"],setup(v,{emit:d}){const u=v,D=d,w=U(""),M=U(),T=U(""),{chats:N,currentChat:S,messages:J,loading:R,error:q,formattedMessages:Q,loadChats:G,loadChatMessages:H,selectChat:_,sendMessage:$,startChatWithUser:E,getChatDisplayName:z,testPusherConnection:F}=Ne(),I=W(()=>S.value?z(S.value):u.initialUser?`Chat com ${u.initialUser.name}`:"Chat"),B=()=>{D("close")},j=async()=>{if(w.value.trim()){console.log("ðŸ’¬ handleSendMessage chamado:",{currentChat:S.value,initialUser:u.initialUser,message:w.value});try{if(T.value="",S.value)console.log("ðŸ’¬ Enviando mensagem para chat existente:",S.value.id),await $(w.value),w.value="";else if(u.initialUser){console.log("ðŸ’¬ Criando novo chat com usuÃ¡rio:",u.initialUser.id);const r=await E(u.initialUser.id,"user");r&&r.id&&(await ue(),await $(w.value),w.value="")}}catch(r){console.error("Erro ao enviar mensagem:",r),T.value="Erro ao enviar mensagem. Tente novamente.",setTimeout(()=>{T.value=""},3e3)}}},te=async()=>{if(u.initialUser&&!S.value)try{console.log("ðŸš€ Iniciando chat com usuÃ¡rio:",u.initialUser);const r=await E(u.initialUser.id,"user");r&&r.id&&(console.log("ðŸ“¥ Carregando mensagens do chat criado:",r.id),await ue(),await H(r.id))}catch(r){console.error("Erro ao inicializar chat:",r),T.value="Erro ao inicializar chat. Tente novamente.",setTimeout(()=>{T.value=""},5e3)}},s=()=>{},i=()=>{ue(()=>{M.value&&(M.value.scrollTop=M.value.scrollHeight)})},g=r=>{if(!r)return"--:--";try{const l=new Date(r);return isNaN(l.getTime())?"--:--":l.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}catch(l){return console.warn("Erro ao formatar data:",l,r),"--:--"}},p=r=>r.isOwn?"VocÃª":r.user_name||"UsuÃ¡rio";return fe(async()=>{u.initialUser||await G(),await te(),window.addEventListener("scroll-to-bottom",i)}),Ue(()=>{window.removeEventListener("scroll-to-bottom",i)}),_e(()=>u.initialChat,r=>{r&&_(r)},{immediate:!0}),_e(()=>u.initialUser,async r=>{if(r&&!S.value)try{await te()}catch(l){console.error("Erro ao inicializar chat com usuÃ¡rio:",l),T.value="Erro ao inicializar chat. Tente novamente.",setTimeout(()=>{T.value=""},5e3)}},{immediate:!0}),_e(S,()=>{S.value&&ue(()=>{i()})}),console.log("ðŸŽ¯ ChatInterface carregado com initialChat:",u.initialChat,"initialUser:",u.initialUser),(r,l)=>{const k=x("v-icon"),A=x("v-btn"),O=x("v-progress-circular"),V=x("v-alert"),h=x("v-avatar"),a=x("v-badge"),P=x("v-text-field"),L=x("v-form");return C(),b("div",Ve,[o("div",Le,[o("div",ze,[o("div",Ie,[m(S)?(C(),ee(A,{key:0,onClick:B,icon:"",size:"small",variant:"text",class:"mr-2"},{default:t(()=>[e(k,null,{default:t(()=>l[2]||(l[2]=[c("mdi-arrow-left")])),_:1})]),_:1})):oe("",!0),e(k,{color:"primary",class:"mr-2"},{default:t(()=>l[3]||(l[3]=[c("mdi-chat")])),_:1}),o("div",null,[o("h3",Re,f(I.value),1),m(S)?(C(),b("p",Fe,f(m(S).type==="private"?"Chat privado":"Chat em grupo"),1)):r.initialUser?(C(),b("p",Oe,f(r.initialUser.email),1)):oe("",!0)])]),o("div",Ge,[e(A,{onClick:m(F),icon:"",size:"small",variant:"text",class:"mr-2",title:"Testar conexÃ£o Pusher"},{default:t(()=>[e(k,null,{default:t(()=>l[4]||(l[4]=[c("mdi-wifi")])),_:1})]),_:1},8,["onClick"]),e(A,{onClick:l[0]||(l[0]=y=>r.$emit("close")),icon:"",size:"small",variant:"text"},{default:t(()=>[e(k,null,{default:t(()=>l[5]||(l[5]=[c("mdi-close")])),_:1})]),_:1})])])]),!m(S)&&!r.initialUser?(C(),b("div",He,[m(R)?(C(),b("div",Be,[e(O,{indeterminate:"",color:"primary"})])):m(q)?(C(),b("div",je,[e(V,{type:"error",variant:"tonal"},{default:t(()=>[c(f(m(q)),1)]),_:1})])):m(N).length===0?(C(),b("div",qe,[e(k,{size:"64",color:"grey",class:"mb-4"},{default:t(()=>l[6]||(l[6]=[c("mdi-chat-outline")])),_:1}),l[7]||(l[7]=o("h3",{class:"text-h6 mb-2"},"Nenhum chat",-1)),l[8]||(l[8]=o("p",{class:"text-body-2 text-grey"}," Inicie um chat com um usuÃ¡rio para comeÃ§ar a conversar. ",-1))])):(C(),b("div",Ke,[(C(!0),b(me,null,ve(m(N),y=>{var se,X,ae;return C(),b("div",{key:y.id,onClick:he=>m(_)(y),class:xe(["conversation-item",{active:((se=m(S))==null?void 0:se.id)===y.id}])},[o("div",Ye,[e(h,{size:"48",color:"primary"},{default:t(()=>[e(k,null,{default:t(()=>l[9]||(l[9]=[c("mdi-account")])),_:1})]),_:1}),y.unread_count>0?(C(),ee(a,{key:0,content:y.unread_count,color:"error",dot:"",class:"conversation-badge"},null,8,["content"])):oe("",!0)]),o("div",Je,[o("div",Qe,[o("h4",Xe,f(m(z)(y)),1),o("span",Ze,f(g((X=y.last_message)==null?void 0:X.created_at)),1)]),o("p",et,f(((ae=y.last_message)==null?void 0:ae.content)||"Nenhuma mensagem ainda"),1)])],10,We)}),128))]))])):(C(),b("div",tt,[o("div",{ref_key:"messagesContainer",ref:M,class:"chat-messages",onScroll:s},[m(R)?(C(),b("div",at,[e(O,{indeterminate:"",color:"primary"})])):m(q)?(C(),b("div",ot,[e(V,{type:"error",variant:"tonal"},{default:t(()=>[c(f(m(q)),1)]),_:1})])):m(J).length===0?(C(),b("div",st,[e(k,{size:"64",color:"grey",class:"mb-4"},{default:t(()=>l[10]||(l[10]=[c("mdi-message-outline")])),_:1}),l[11]||(l[11]=o("h3",{class:"text-h6 mb-2"},"Nenhuma mensagem",-1)),o("p",lt,f(r.initialUser?`Inicie um chat com ${r.initialUser.name}!`:"Seja o primeiro a enviar uma mensagem!"),1)])):(C(),b("div",nt,[(C(!0),b(me,null,ve(m(Q),y=>(C(),b("div",{key:y.id,class:xe(["message-item",{"message-own":y.isOwn}])},[o("div",rt,[o("div",it,[o("span",dt,f(p(y)),1),o("span",ut,f(y.time),1)]),o("div",ct,f(y.content),1)])],2))),128))]))],544),o("div",mt,[T.value?(C(),b("div",vt,[e(V,{type:"error",variant:"tonal",density:"compact"},{default:t(()=>[c(f(T.value),1)]),_:1})])):oe("",!0),e(L,{onSubmit:$e(j,["prevent"])},{default:t(()=>[o("div",pt,[e(P,{modelValue:w.value,"onUpdate:modelValue":l[1]||(l[1]=y=>w.value=y),onKeydown:De(j,["enter"]),placeholder:r.initialUser?`Digite uma mensagem para ${r.initialUser.name}...`:"Digite sua mensagem...",variant:"outlined",density:"compact","hide-details":"",class:"flex-grow-1 mr-2",disabled:m(R)},null,8,["modelValue","placeholder","disabled"]),e(A,{onClick:j,color:"primary",icon:"",disabled:!w.value.trim()||m(R)},{default:t(()=>[e(k,null,{default:t(()=>l[12]||(l[12]=[c("mdi-send")])),_:1})]),_:1},8,["disabled"])])]),_:1})])]))])}}}),_t=ke(gt,[["__scopeId","data-v-72bf487a"]]),ft=()=>{const v=U([]),d=U(null),u=U(!1),D=U(null),w=new Me,M=async(_=1,$=15)=>{u.value=!0,D.value=null;try{const E=await w.getUsers(_,$);E.success&&E.data?(v.value=E.data.users,d.value=E.data.pagination):D.value=E.error||"Failed to load users"}catch{D.value="Unexpected error loading users"}finally{u.value=!1}},T=()=>{d.value&&d.value.current_page<d.value.last_page&&M(d.value.current_page+1,d.value.per_page)},N=()=>{d.value&&d.value.current_page>1&&M(d.value.current_page-1,d.value.per_page)},S=_=>{d.value&&_>=1&&_<=d.value.last_page&&M(_,d.value.per_page)},J=_=>{M(1,_)},R=_=>({..._,role:"User",status:_.email_verified_at?"Ativo":"Pendente",statusColor:_.email_verified_at?"success":"warning",avatar:`/images/profile/user-${_.id%8+1}.jpg`,phone:`+55 (11) ${String(_.id).padStart(5,"0")}-${String(_.id).padStart(4,"0")}`,department:"TI",lastLogin:_.email_verified_at?_.updated_at:"Nunca"}),q=W(()=>v.value.map(R)),Q=W(()=>d.value&&d.value.current_page<d.value.last_page),G=W(()=>d.value&&d.value.current_page>1),H=W(()=>{if(!d.value)return[];const _=[],$=d.value.current_page,E=d.value.last_page;let z=Math.max(1,$-2),F=Math.min(E,$+2);$<=3?F=Math.min(E,5):$>=E-2&&(z=Math.max(1,E-4));for(let I=z;I<=F;I++)_.push(I);return _});return{users:K(v),pagination:K(d),loading:K(u),error:K(D),formattedUsers:q,canGoNext:Q,canGoPrev:G,pageNumbers:H,loadUsers:M,nextPage:T,prevPage:N,goToPage:S,changePerPage:J,formatUserForDisplay:R}},ht={class:"d-flex align-center justify-space-between"},Ct={class:"d-flex gap-2"},yt={class:"d-flex justify-center align-center py-8"},xt={class:"d-flex align-center"},wt=["src","alt"],bt={class:"font-weight-medium"},Ut={class:"text-caption text-medium-emphasis"},Et={class:"d-flex justify-center gap-1"},kt={key:0,class:"d-flex align-center justify-space-between mt-4"},St={class:"text-body-2 text-medium-emphasis"},Pt={class:"d-flex align-center gap-2"},Tt={class:"d-flex gap-1"},$t={class:"text-body-2"},Dt={class:"d-flex align-center gap-3"},Mt={class:"text-h6"},At={class:"text-caption text-medium-emphasis"},Nt=Ee({__name:"index",setup(v){const{formattedUsers:d,pagination:u,loading:D,error:w,loadUsers:M,nextPage:T,prevPage:N,goToPage:S,changePerPage:J,canGoNext:R,canGoPrev:q,pageNumbers:Q}=ft(),G=U(""),H=U("all"),_=U("all"),$=U("all"),E=U(!1),z=U(!1),F=U(!1),I=U(null),B=U(!1),j=U(null),te=[{value:"all",label:"Todos os Status"},{value:"Ativo",label:"Ativo"},{value:"Pendente",label:"Pendente"}],s=[{value:"all",label:"Todos os Roles"},{value:"User",label:"User"}],i=[{value:"all",label:"Todos os Departamentos"},{value:"TI",label:"TI"}],g=W(()=>d.value.filter(h=>{const a=h.name.toLowerCase().includes(G.value.toLowerCase())||h.email.toLowerCase().includes(G.value.toLowerCase()),P=H.value==="all"||h.status===H.value,L=_.value==="all"||h.role===_.value,y=$.value==="all"||h.department===$.value;return a&&P&&L&&y})),p=()=>{E.value=!0},r=h=>{I.value={...h},z.value=!0},l=h=>{I.value=h,F.value=!0},k=()=>{var h,a;I.value&&(F.value=!1,I.value=null,M(((h=u.value)==null?void 0:h.current_page)||1,((a=u.value)==null?void 0:a.per_page)||15))},A=h=>{h.status==="Ativo"?(h.status="Pendente",h.statusColor="warning"):(h.status="Ativo",h.statusColor="success")},O=async h=>{console.log("Iniciando chat com usuÃ¡rio:",h),j.value=h,B.value=!0},V=()=>{G.value="",H.value="all",_.value="all",$.value="all"};return fe(()=>{M()}),(h,a)=>{const P=x("v-btn"),L=x("v-col"),y=x("v-row"),se=x("v-text-field"),X=x("v-select"),ae=x("v-chip"),he=x("v-progress-circular"),Se=x("v-alert"),Ce=x("v-avatar"),Y=x("v-icon"),Pe=x("v-table"),le=x("v-card-title"),ne=x("v-card-text"),pe=x("v-spacer"),ge=x("v-card-actions"),re=x("v-card"),ie=x("v-dialog"),Te=_t;return C(),b("div",null,[e(y,{class:"mb-4"},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[o("div",ht,[a[16]||(a[16]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold"},"UsuÃ¡rios"),o("p",{class:"text-body-1 text-medium-emphasis"}," Gerencie todos os usuÃ¡rios do sistema ")],-1)),e(P,{color:"primary","prepend-icon":"mdi-plus",onClick:p,size:"large"},{default:t(()=>a[15]||(a[15]=[c(" Adicionar UsuÃ¡rio ")])),_:1})])]),_:1})]),_:1}),e(y,{class:"mb-6"},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(ce,{title:"Filtros"},{default:t(()=>[e(y,null,{default:t(()=>[e(L,{cols:"12",md:"3"},{default:t(()=>[e(se,{modelValue:G.value,"onUpdate:modelValue":a[0]||(a[0]=n=>G.value=n),label:"Buscar por nome ou email","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(L,{cols:"12",md:"3"},{default:t(()=>[e(X,{modelValue:H.value,"onUpdate:modelValue":a[1]||(a[1]=n=>H.value=n),items:te,"item-title":"label","item-value":"value",label:"Status",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(L,{cols:"12",md:"3"},{default:t(()=>[e(X,{modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=n=>_.value=n),items:s,"item-title":"label","item-value":"value",label:"Role",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(L,{cols:"12",md:"3"},{default:t(()=>[e(X,{modelValue:$.value,"onUpdate:modelValue":a[3]||(a[3]=n=>$.value=n),items:i,"item-title":"label","item-value":"value",label:"Departamento",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[o("div",Ct,[e(P,{variant:"outlined",onClick:V,"prepend-icon":"mdi-refresh"},{default:t(()=>a[17]||(a[17]=[c(" Limpar Filtros ")])),_:1}),e(ae,{color:"primary",variant:"tonal",class:"ml-auto"},{default:t(()=>[c(f(g.value.length)+" usuÃ¡rios encontrados ",1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),m(D)?(C(),ee(y,{key:0},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(ce,null,{default:t(()=>[o("div",yt,[e(he,{indeterminate:"",color:"primary",size:"64"})])]),_:1})]),_:1})]),_:1})):m(w)?(C(),ee(y,{key:1},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(ce,null,{default:t(()=>[e(Se,{type:"error",variant:"tonal",class:"mb-0"},{default:t(()=>[c(f(m(w)),1)]),_:1})]),_:1})]),_:1})]),_:1})):(C(),ee(y,{key:2},{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(ce,{title:"Lista de UsuÃ¡rios"},{default:t(()=>[e(Pe,{"fixed-header":"",height:"600px"},{default:t(()=>[a[21]||(a[21]=o("thead",null,[o("tr",null,[o("th",{class:"text-left"},"UsuÃ¡rio"),o("th",{class:"text-left"},"Email"),o("th",{class:"text-left"},"Role"),o("th",{class:"text-left"},"Departamento"),o("th",{class:"text-left"},"Status"),o("th",{class:"text-left"},"Ãšltimo Login"),o("th",{class:"text-left"},"Criado em"),o("th",{class:"text-center"},"AÃ§Ãµes")])],-1)),o("tbody",null,[(C(!0),b(me,null,ve(g.value,n=>(C(),b("tr",{key:n.id},[o("td",null,[o("div",xt,[e(Ce,{size:"40",class:"mr-3"},{default:t(()=>[o("img",{src:n.avatar,alt:n.name},null,8,wt)]),_:2},1024),o("div",null,[o("div",bt,f(n.name),1),o("div",Ut,f(n.phone),1)])])]),o("td",null,f(n.email),1),o("td",null,[e(ae,{color:n.role==="Admin"?"error":n.role==="Manager"?"warning":n.role==="Editor"?"info":"default",variant:"tonal",size:"small"},{default:t(()=>[c(f(n.role),1)]),_:2},1032,["color"])]),o("td",null,f(n.department),1),o("td",null,[e(ae,{color:n.statusColor,variant:"tonal",size:"small"},{default:t(()=>[c(f(n.status),1)]),_:2},1032,["color"])]),o("td",null,f(n.lastLogin),1),o("td",null,f(new Date(n.created_at).toLocaleDateString("pt-BR")),1),o("td",null,[o("div",Et,[e(P,{icon:"",size:"small",variant:"text",color:"info",onClick:Z=>O(n),title:"Iniciar Chat"},{default:t(()=>[e(Y,null,{default:t(()=>a[18]||(a[18]=[c("mdi-chat")])),_:1})]),_:2},1032,["onClick"]),e(P,{icon:"",size:"small",variant:"text",color:"primary",onClick:Z=>r(n),title:"Editar"},{default:t(()=>[e(Y,null,{default:t(()=>a[19]||(a[19]=[c("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),e(P,{icon:"",size:"small",variant:"text",color:n.status==="Ativo"?"warning":"success",onClick:Z=>A(n),title:n.status==="Ativo"?"Desativar":"Ativar"},{default:t(()=>[e(Y,null,{default:t(()=>[c(f(n.status==="Ativo"?"mdi-account-off":"mdi-account-check"),1)]),_:2},1024)]),_:2},1032,["color","onClick","title"]),e(P,{icon:"",size:"small",variant:"text",color:"error",onClick:Z=>l(n),title:"Excluir"},{default:t(()=>[e(Y,null,{default:t(()=>a[20]||(a[20]=[c("mdi-delete")])),_:1})]),_:2},1032,["onClick"])])])]))),128))])]),_:1}),m(u)?(C(),b("div",kt,[o("div",St," Mostrando "+f(m(u).from)+" a "+f(m(u).to)+" de "+f(m(u).total)+" usuÃ¡rios ",1),o("div",Pt,[e(X,{"model-value":m(u).per_page,"onUpdate:modelValue":m(J),items:[10,15,25,50],variant:"outlined",density:"compact","hide-details":"",style:{width:"80px"}},null,8,["model-value","onUpdate:modelValue"]),e(P,{icon:"",variant:"text",disabled:!m(q),onClick:m(N),title:"PÃ¡gina anterior"},{default:t(()=>[e(Y,null,{default:t(()=>a[22]||(a[22]=[c("mdi-chevron-left")])),_:1})]),_:1},8,["disabled","onClick"]),o("div",Tt,[(C(!0),b(me,null,ve(m(Q),n=>(C(),ee(P,{key:n,color:n===m(u).current_page?"primary":void 0,variant:"text",size:"small",onClick:Z=>m(S)(n)},{default:t(()=>[c(f(n),1)]),_:2},1032,["color","onClick"]))),128))]),e(P,{icon:"",variant:"text",disabled:!m(R),onClick:m(T),title:"PrÃ³xima pÃ¡gina"},{default:t(()=>[e(Y,null,{default:t(()=>a[23]||(a[23]=[c("mdi-chevron-right")])),_:1})]),_:1},8,["disabled","onClick"])])])):oe("",!0)]),_:1})]),_:1})]),_:1})),e(ie,{modelValue:E.value,"onUpdate:modelValue":a[6]||(a[6]=n=>E.value=n),"max-width":"600px"},{default:t(()=>[e(re,null,{default:t(()=>[e(le,{class:"text-h5"},{default:t(()=>a[24]||(a[24]=[c(" Adicionar Novo UsuÃ¡rio ")])),_:1}),e(ne,null,{default:t(()=>a[25]||(a[25]=[o("p",{class:"text-body-2 text-medium-emphasis"}," FormulÃ¡rio de adiÃ§Ã£o de usuÃ¡rio serÃ¡ implementado aqui. ",-1)])),_:1}),e(ge,null,{default:t(()=>[e(pe),e(P,{color:"grey-darken-1",variant:"text",onClick:a[4]||(a[4]=n=>E.value=!1)},{default:t(()=>a[26]||(a[26]=[c(" Cancelar ")])),_:1}),e(P,{color:"primary",onClick:a[5]||(a[5]=n=>E.value=!1)},{default:t(()=>a[27]||(a[27]=[c(" Adicionar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ie,{modelValue:z.value,"onUpdate:modelValue":a[9]||(a[9]=n=>z.value=n),"max-width":"600px"},{default:t(()=>[e(re,null,{default:t(()=>[e(le,{class:"text-h5"},{default:t(()=>a[28]||(a[28]=[c(" Editar UsuÃ¡rio ")])),_:1}),e(ne,null,{default:t(()=>a[29]||(a[29]=[o("p",{class:"text-body-2 text-medium-emphasis"}," FormulÃ¡rio de ediÃ§Ã£o serÃ¡ implementado aqui. ",-1)])),_:1}),e(ge,null,{default:t(()=>[e(pe),e(P,{color:"grey-darken-1",variant:"text",onClick:a[7]||(a[7]=n=>z.value=!1)},{default:t(()=>a[30]||(a[30]=[c(" Cancelar ")])),_:1}),e(P,{color:"primary",onClick:a[8]||(a[8]=n=>z.value=!1)},{default:t(()=>a[31]||(a[31]=[c(" Salvar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ie,{modelValue:F.value,"onUpdate:modelValue":a[11]||(a[11]=n=>F.value=n),"max-width":"400px"},{default:t(()=>[e(re,null,{default:t(()=>[e(le,{class:"text-h5"},{default:t(()=>a[32]||(a[32]=[c(" Confirmar ExclusÃ£o ")])),_:1}),e(ne,null,{default:t(()=>{var n;return[o("p",$t,[a[33]||(a[33]=c(" Tem certeza que deseja excluir o usuÃ¡rio ")),o("strong",null,f((n=I.value)==null?void 0:n.name),1),a[34]||(a[34]=c("? "))]),a[35]||(a[35]=o("p",{class:"text-caption text-medium-emphasis"}," Esta aÃ§Ã£o nÃ£o pode ser desfeita. ",-1))]}),_:1}),e(ge,null,{default:t(()=>[e(pe),e(P,{color:"grey-darken-1",variant:"text",onClick:a[10]||(a[10]=n=>F.value=!1)},{default:t(()=>a[36]||(a[36]=[c(" Cancelar ")])),_:1}),e(P,{color:"error",onClick:k},{default:t(()=>a[37]||(a[37]=[c(" Excluir ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ie,{modelValue:B.value,"onUpdate:modelValue":a[14]||(a[14]=n=>B.value=n),"max-width":"800px",persistent:""},{default:t(()=>[e(re,{class:"chat-dialog-card"},{default:t(()=>[e(le,{class:"d-flex align-center justify-space-between pa-4"},{default:t(()=>{var n,Z;return[o("div",Dt,[e(Ce,{size:"40",color:"primary"},{default:t(()=>[e(Y,null,{default:t(()=>a[38]||(a[38]=[c("mdi-account")])),_:1})]),_:1}),o("div",null,[o("div",Mt,"Chat com "+f((n=j.value)==null?void 0:n.name),1),o("div",At,f((Z=j.value)==null?void 0:Z.email),1)])]),e(P,{icon:"",variant:"text",onClick:a[12]||(a[12]=Vt=>B.value=!1),title:"Fechar"},{default:t(()=>[e(Y,null,{default:t(()=>a[39]||(a[39]=[c("mdi-close")])),_:1})]),_:1})]}),_:1}),e(ne,{class:"chat-dialog-content pa-0"},{default:t(()=>[j.value?(C(),ee(Te,{key:0,"initial-chat":null,"initial-user":j.value,onClose:a[13]||(a[13]=n=>B.value=!1)},null,8,["initial-user"])):oe("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Rt=ke(Nt,[["__scopeId","data-v-ac981c7e"]]);export{Rt as default};
