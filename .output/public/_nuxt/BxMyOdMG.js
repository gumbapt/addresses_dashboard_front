import{U as De}from"./vwmodq-X.js";import{_ as w}from"./btuBwFtU.js";import{d as we,I as ke,l as y,e as z,o as Se,H as Q,c as u,a as t,h as C,i as $,w as a,r as _,q as r,g as s,j as m,t as c,y as Re,z as ze,F as Ce,m as Ve,n as X,b as o,D as qe,_ as Ae}from"./AmEn0FOG.js";import{u as Fe}from"./jJGlrcqN.js";import{u as Le}from"./DyD9CpYx.js";import{u as Pe}from"./DdKHjOGv.js";const Te={class:"d-flex align-center justify-space-between flex-wrap gap-4"},Ne={class:"flex-grow-1"},Oe={class:"text-h4 font-weight-bold"},je={key:0,class:"text-body-1 text-medium-emphasis"},Ie={class:"d-flex gap-2 align-center",style:{"min-width":"300px"}},Ue={key:0,class:"text-caption"},We={key:1,class:"text-caption"},Be={class:"text-caption text-medium-emphasis mb-2"},$e={key:1},Me={class:"d-flex align-center justify-space-between mb-3"},Ye={class:"mb-2"},Ee={class:"text-h6"},He={class:"mb-2"},Ke={class:"text-body-2"},Ge={key:2},Je={class:"d-flex justify-center align-center py-8"},Qe={key:2},Xe={class:"d-flex align-center justify-space-between mb-2"},Ze={class:"text-h3 font-weight-bold text-primary"},et={class:"d-flex align-center justify-space-between mb-2"},tt={class:"text-h3 font-weight-bold text-success"},at={class:"d-flex align-center justify-space-between mb-2"},lt={class:"text-h3 font-weight-bold text-info"},st={class:"d-flex align-center justify-space-between mb-2"},ot={class:"text-h3 font-weight-bold text-warning"},it={key:0},nt={key:1,class:"text-center py-8"},dt={key:0},rt={key:1,class:"text-center py-8"},ut={key:0},mt={key:1,class:"text-center py-8"},pt={key:0},ct={key:1,class:"text-center py-8"},vt=we({__name:"dashboard",setup(ft){const D=ke(),F=y(()=>parseInt(D.params.id)),{reportData:Z,aggregatedData:M,loading:ee,error:Y,loadDashboardStats:te,loadAggregatedStats:ae,providerChartData:O,topStatesChartData:j,speedByStateChartData:I,technologyChartData:U,topCards:L}=Fe(),{formattedReports:le,loading:se,loadReports:oe}=Le(),{domains:W,loadDomains:ie}=Pe(),p=z("all"),k=z(!1),g=z(null),h=z(null),b=z(null),ne=[{title:"ðŸ“… Today",value:"today"},{title:"ðŸ“… Yesterday",value:"yesterday"},{title:"ðŸ“… Last Week",value:"last_week"},{title:"ðŸ“… Last Month",value:"last_month"},{title:"ðŸ“… Last Year",value:"last_year"},{title:"ðŸ“… All Time",value:"all_time"}],de=y(()=>!W.value||!Array.isArray(W.value)?null:W.value.find(l=>l.id===F.value)),V=y(()=>le.value.filter(l=>l.domain_id===F.value)),re=y(()=>[...[{id:"all",reportDate:"All Reports Combined",statusColor:"primary",data_version:"Aggregated"}],...V.value]),B=y(()=>p.value==="all"?{id:"all",reportDate:"All Reports Combined",statusLabel:"Aggregated"}:V.value.find(l=>l.id===p.value)),E=y(()=>p.value==="all"&&M.value?`Showing aggregated data from ${V.value.length} report(s)`:B.value&&p.value!=="all"?`Report Date: ${B.value.reportDate} | Status: ${B.value.statusLabel}`:"");Se(async()=>{await ie(),await oe({domain_id:F.value,per_page:100}),D.query.date_from&&(h.value=D.query.date_from),D.query.date_to&&(b.value=D.query.date_to),D.query.period&&(g.value=D.query.period),await P(),p.value="all",K.value=!0});const ue=l=>{if(!l||l==="all_time")return{date_from:null,date_to:null};const e=new Date;e.setHours(0,0,0,0);let n,x=new Date(e);switch(l){case"today":n=new Date(e),x=new Date(e);break;case"yesterday":n=new Date(e),n.setDate(n.getDate()-1),x=new Date(n);break;case"last_week":n=new Date(e),n.setDate(n.getDate()-6);break;case"last_month":n=new Date(e),n.setDate(n.getDate()-29);break;case"last_year":n=new Date(e),n.setDate(n.getDate()-364);break;default:return{date_from:null,date_to:null}}const T=S=>{const f=S.getFullYear(),i=String(S.getMonth()+1).padStart(2,"0"),v=String(S.getDate()).padStart(2,"0");return`${f}-${i}-${v}`};return{date_from:T(n),date_to:T(x)}},me=()=>{if(g.value){const l=ue(g.value);h.value=l.date_from,b.value=l.date_to}else h.value=null,b.value=null;H(),P()},H=()=>{const l={};h.value&&(l.date_from=h.value),b.value&&(l.date_to=b.value),g.value&&(l.period=g.value),X({query:Object.keys(l).length>0?l:{}},{replace:!0})},P=async()=>{p.value==="all"?(k.value=!1,await ae(F.value,{period:g.value,date_from:h.value,date_to:b.value})):p.value&&(k.value=!1,await te(p.value))};Q(p,()=>{P()});const K=z(!1);Q([h,b],([l,e],[n,x])=>{K.value&&p.value==="all"&&(g.value=null,H(),P())});const pe=y(()=>({chart:{type:"donut",fontFamily:"inherit",height:350},title:{text:"Provider Distribution",align:"left",style:{fontSize:"18px",fontWeight:600}},labels:O.value.labels,responsive:[{breakpoint:480,options:{chart:{width:300},legend:{position:"bottom"}}}],plotOptions:{pie:{donut:{labels:{show:!0,total:{show:!0,label:"Total",fontSize:"20px",fontWeight:600}}}}},legend:{position:"bottom"},dataLabels:{enabled:!0,formatter:function(l){return l.toFixed(1)+"%"}}})),ce=y(()=>({chart:{type:"bar",fontFamily:"inherit",height:350,toolbar:{show:!1}},title:{text:"Top States by Requests",align:"left",style:{fontSize:"18px",fontWeight:600}},plotOptions:{bar:{horizontal:!1,borderRadius:8,columnWidth:"55%",distributed:!1}},dataLabels:{enabled:!1},xaxis:{categories:j.value.categories,labels:{style:{fontSize:"12px"}}},yaxis:{title:{text:"Number of Requests"}},colors:["#1976d2"],grid:{show:!0,borderColor:"#f0f0f0"}})),ve=y(()=>({chart:{type:"bar",fontFamily:"inherit",height:350,toolbar:{show:!1}},title:{text:"Average Speed by State",align:"left",style:{fontSize:"18px",fontWeight:600}},plotOptions:{bar:{horizontal:!1,borderRadius:8,columnWidth:"55%",distributed:!1}},dataLabels:{enabled:!1},xaxis:{categories:I.value.categories,labels:{style:{fontSize:"12px"}}},yaxis:{title:{text:"Average Speed (Mbps)"}},colors:["#4caf50"],grid:{show:!0,borderColor:"#f0f0f0"}})),fe=y(()=>({chart:{type:"donut",fontFamily:"inherit",height:350},title:{text:"Technology Distribution",align:"left",style:{fontSize:"18px",fontWeight:600}},labels:U.value.labels,responsive:[{breakpoint:480,options:{chart:{width:300},legend:{position:"bottom"}}}],plotOptions:{pie:{donut:{labels:{show:!0,total:{show:!0,label:"Total",fontSize:"20px",fontWeight:600}}}}},legend:{position:"bottom"},dataLabels:{enabled:!0,formatter:function(l){return l.toFixed(1)+"%"}}})),_e=l=>l>=1e6?(l/1e6).toFixed(1)+"M":l>=1e3?(l/1e3).toFixed(1)+"K":l.toString(),ge=l=>l.toFixed(1)+"%",ye=l=>l.toFixed(2),he=()=>{X("/domains")},be=()=>{k.value=!k.value};return(l,e)=>{const n=_("v-btn"),x=_("v-chip"),T=_("v-list-item"),S=_("v-select"),f=_("v-icon"),i=_("v-col"),v=_("v-row"),G=De,R=_("v-card"),J=_("v-alert"),q=_("v-card-text"),xe=_("v-progress-circular"),N=_("apexchart");return o(),u("div",null,[t(v,{class:"mb-4"},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[s("div",Te,[s("div",Ne,[t(n,{variant:"text","prepend-icon":"mdi-arrow-left",onClick:he,class:"mb-2"},{default:a(()=>e[4]||(e[4]=[m(" Back to Domains ")])),_:1}),s("h1",Oe,c(de.value?.name||"Domain Dashboard"),1),E.value?(o(),u("p",je,c(E.value),1)):$("",!0)]),s("div",Ie,[t(S,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=d=>p.value=d),items:re.value,"item-title":"reportDate","item-value":"id",label:"Select Report",variant:"outlined",density:"compact","hide-details":"",loading:r(se),"prepend-inner-icon":"mdi-calendar"},{item:a(({props:d,item:A})=>[t(T,Re(ze(d)),{prepend:a(()=>[t(x,{color:A.raw.statusColor,size:"x-small",variant:"tonal"},null,8,["color"])]),subtitle:a(()=>[A.raw.id!=="all"?(o(),u("span",Ue,"ID: "+c(A.raw.id)+" | Version: "+c(A.raw.data_version),1)):(o(),u("span",We,"Combined data from all reports"))]),_:2},1040)]),_:1},8,["modelValue","items","loading"]),t(n,{icon:"",variant:"outlined",onClick:be,title:"View all reports"},{default:a(()=>[t(f,null,{default:a(()=>[m(c(k.value?"mdi-view-dashboard":"mdi-view-list"),1)]),_:1})]),_:1})])])]),_:1})]),_:1}),p.value==="all"?(o(),C(v,{key:0,class:"mb-4"},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(R,{variant:"outlined",class:"pa-3"},{default:a(()=>[s("div",Be,[t(f,{size:"small",class:"mr-1"},{default:a(()=>e[5]||(e[5]=[m("mdi-filter")])),_:1}),e[6]||(e[6]=m(" Filter by Period or Date Range "))]),t(v,null,{default:a(()=>[t(i,{cols:"12",md:"3"},{default:a(()=>[t(S,{modelValue:g.value,"onUpdate:modelValue":[e[1]||(e[1]=d=>g.value=d),me],items:ne,label:"Period",clearable:"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-calendar-range"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(G,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=d=>h.value=d),label:"Start Date","prepend-inner-icon":"mdi-calendar-start"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(G,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=d=>b.value=d),label:"End Date","prepend-inner-icon":"mdi-calendar-end"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):$("",!0),k.value?(o(),u("div",$e,[t(v,null,{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(w,{title:"All Reports"},{default:a(()=>[V.value.length===0?(o(),C(v,{key:0},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(J,{type:"info",variant:"tonal"},{default:a(()=>e[7]||(e[7]=[m(" No reports available for this domain yet. ")])),_:1})]),_:1})]),_:1})):(o(),C(v,{key:1},{default:a(()=>[(o(!0),u(Ce,null,Ve(V.value,d=>(o(),C(i,{key:d.id,cols:"12",sm:"6",md:"4",lg:"3"},{default:a(()=>[t(R,{elevation:"2",hover:"",class:qe(["h-100",{"border-primary":p.value===d.id}]),onClick:A=>p.value=d.id,style:{cursor:"pointer"}},{default:a(()=>[t(q,null,{default:a(()=>[s("div",Me,[t(x,{color:d.statusColor,variant:"tonal",size:"small"},{default:a(()=>[m(c(d.statusLabel),1)]),_:2},1032,["color"])]),s("div",Ye,[e[8]||(e[8]=s("div",{class:"text-overline text-medium-emphasis"},"Date",-1)),s("div",Ee,c(d.reportDate),1)]),s("div",He,[e[9]||(e[9]=s("div",{class:"text-overline text-medium-emphasis"},"Report ID",-1)),s("div",Ke,"#"+c(d.id),1)]),s("div",null,[e[10]||(e[10]=s("div",{class:"text-overline text-medium-emphasis"},"Version",-1)),t(x,{variant:"outlined",size:"x-small"},{default:a(()=>[m(c(d.data_version),1)]),_:2},1024)])]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1})])):(o(),u("div",Ge,[r(ee)?(o(),C(v,{key:0},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(w,null,{default:a(()=>[s("div",Je,[t(xe,{indeterminate:"",color:"primary",size:"64"})])]),_:1})]),_:1})]),_:1})):r(Y)?(o(),C(v,{key:1},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(w,null,{default:a(()=>[t(J,{type:"error",variant:"tonal",class:"mb-0"},{default:a(()=>[m(c(r(Y)),1)]),_:1})]),_:1})]),_:1})]),_:1})):r(Z)||r(M)?(o(),u("div",Qe,[t(v,{class:"mb-4"},{default:a(()=>[t(i,{cols:"12",sm:"6",md:"3"},{default:a(()=>[t(R,{elevation:"2",class:"h-100"},{default:a(()=>[t(q,null,{default:a(()=>[s("div",Xe,[e[12]||(e[12]=s("div",{class:"text-h6 text-medium-emphasis"},"Total Requests",-1)),t(f,{color:"primary",size:"32"},{default:a(()=>e[11]||(e[11]=[m("mdi-chart-line")])),_:1})]),s("div",Ze,c(_e(r(L).totalRequests)),1),e[13]||(e[13]=s("div",{class:"text-caption text-medium-emphasis mt-1"}," All time requests ",-1))]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",sm:"6",md:"3"},{default:a(()=>[t(R,{elevation:"2",class:"h-100"},{default:a(()=>[t(q,null,{default:a(()=>[s("div",et,[e[15]||(e[15]=s("div",{class:"text-h6 text-medium-emphasis"},"Success Rate",-1)),t(f,{color:"success",size:"32"},{default:a(()=>e[14]||(e[14]=[m("mdi-check-circle")])),_:1})]),s("div",tt,c(ge(r(L).successRate)),1),e[16]||(e[16]=s("div",{class:"text-caption text-medium-emphasis mt-1"}," Successful requests ",-1))]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",sm:"6",md:"3"},{default:a(()=>[t(R,{elevation:"2",class:"h-100"},{default:a(()=>[t(q,null,{default:a(()=>[s("div",at,[e[18]||(e[18]=s("div",{class:"text-h6 text-medium-emphasis"},"Daily Average",-1)),t(f,{color:"info",size:"32"},{default:a(()=>e[17]||(e[17]=[m("mdi-calendar-today")])),_:1})]),s("div",lt,c(ye(r(L).dailyAverage)),1),e[19]||(e[19]=s("div",{class:"text-caption text-medium-emphasis mt-1"}," Average per day ",-1))]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",sm:"6",md:"3"},{default:a(()=>[t(R,{elevation:"2",class:"h-100"},{default:a(()=>[t(q,null,{default:a(()=>[s("div",st,[e[21]||(e[21]=s("div",{class:"text-h6 text-medium-emphasis"},"Unique Providers",-1)),t(f,{color:"warning",size:"32"},{default:a(()=>e[20]||(e[20]=[m("mdi-domain")])),_:1})]),s("div",ot,c(r(L).uniqueProviders),1),e[22]||(e[22]=s("div",{class:"text-caption text-medium-emphasis mt-1"}," Different providers ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),t(v,{class:"mb-4"},{default:a(()=>[t(i,{cols:"12",md:"6"},{default:a(()=>[t(w,null,{default:a(()=>[r(O).series.length>0?(o(),u("div",it,[t(N,{type:"donut",height:"350",options:pe.value,series:r(O).series},null,8,["options","series"])])):(o(),u("div",nt,[t(f,{size:"64",color:"grey"},{default:a(()=>e[23]||(e[23]=[m("mdi-chart-donut")])),_:1}),e[24]||(e[24]=s("p",{class:"text-h6 mt-4 text-medium-emphasis"},"No provider data available",-1))]))]),_:1})]),_:1}),t(i,{cols:"12",md:"6"},{default:a(()=>[t(w,null,{default:a(()=>[r(j).data.length>0?(o(),u("div",dt,[t(N,{type:"bar",height:"350",options:ce.value,series:[{name:"Requests",data:r(j).data}]},null,8,["options","series"])])):(o(),u("div",rt,[t(f,{size:"64",color:"grey"},{default:a(()=>e[25]||(e[25]=[m("mdi-chart-bar")])),_:1}),e[26]||(e[26]=s("p",{class:"text-h6 mt-4 text-medium-emphasis"},"No state data available",-1))]))]),_:1})]),_:1})]),_:1}),t(v,null,{default:a(()=>[t(i,{cols:"12",md:"6"},{default:a(()=>[t(w,null,{default:a(()=>[r(I).data.length>0?(o(),u("div",ut,[t(N,{type:"bar",height:"350",options:ve.value,series:[{name:"Avg Speed (Mbps)",data:r(I).data}]},null,8,["options","series"])])):(o(),u("div",mt,[t(f,{size:"64",color:"grey"},{default:a(()=>e[27]||(e[27]=[m("mdi-speedometer")])),_:1}),e[28]||(e[28]=s("p",{class:"text-h6 mt-4 text-medium-emphasis"},"No speed data available",-1))]))]),_:1})]),_:1}),t(i,{cols:"12",md:"6"},{default:a(()=>[t(w,null,{default:a(()=>[r(U).series.length>0?(o(),u("div",pt,[t(N,{type:"donut",height:"350",options:fe.value,series:r(U).series},null,8,["options","series"])])):(o(),u("div",ct,[t(f,{size:"64",color:"grey"},{default:a(()=>e[29]||(e[29]=[m("mdi-chart-donut")])),_:1}),e[30]||(e[30]=s("p",{class:"text-h6 mt-4 text-medium-emphasis"},"No technology data available",-1))]))]),_:1})]),_:1})]),_:1})])):$("",!0)]))])}}}),Dt=Ae(vt,[["__scopeId","data-v-3e20744c"]]);export{Dt as default};
