import{d as we,v as Ce,f as De,e as k,l as Ue,o as Ae,c as D,a as l,h as x,w as a,r as c,q as r,g as o,i as w,j as d,t as m,F as Q,m as X,b as f,n as Pe}from"./B7XrKrHi.js";import{_ as B}from"./j2ADEBOt.js";import{u as ze}from"./CJu1SwDQ.js";const Se={class:"d-flex align-center justify-space-between"},Ie={class:"d-flex gap-2"},Te={class:"d-flex justify-center align-center py-8"},Ee={class:"font-weight-medium"},Fe={class:"text-caption text-medium-emphasis"},$e=["href"],Le={class:"d-flex justify-center gap-1"},Ne={key:0,class:"d-flex justify-end mt-4"},Ke={class:"text-body-2 text-medium-emphasis"},je={key:1,class:"d-flex align-center justify-space-between mt-4"},Re={class:"text-body-2 text-medium-emphasis"},qe={class:"d-flex align-center gap-2"},Oe={class:"d-flex gap-1"},Be={key:0},We={class:"mt-4"},Ye=we({__name:"index",setup(Ge){const{formattedDomains:Z,pagination:p,loading:ee,error:W,loadDomains:A,nextPage:le,prevPage:ae,goToPage:te,changePerPage:oe,canGoNext:ne,canGoPrev:ie,pageNumbers:se,createDomain:ue,updateDomain:de,deleteDomain:re,regenerateApiKey:ve}=ze(),{hasPermission:C}=Ce(),V=De(),P=k(""),z=k("all"),S=k(!1),I=k(!1),T=k(!1),F=k(!1),_=k(null),i=k({name:"",domain_url:"",site_id:"",timezone:"UTC",wordpress_version:"",plugin_version:"",is_active:!0}),g=k(!1),y=k(null),me=[{value:"all",label:"All Status"},{value:"Ativo",label:"Active"},{value:"Inativo",label:"Inactive"}],G=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Sao_Paulo","Europe/London","Europe/Paris","Asia/Tokyo","Australia/Sydney"],M=Ue(()=>Z.value.filter(u=>{const e=u.name.toLowerCase().includes(P.value.toLowerCase())||u.domain_url.toLowerCase().includes(P.value.toLowerCase()),n=z.value==="all"||(z.value==="Ativo"?u.is_active:!u.is_active);return e&&n})),pe=()=>{C("domain-create")&&(i.value={name:"",domain_url:"",site_id:"",timezone:"UTC",wordpress_version:"",plugin_version:"",is_active:!0},S.value=!0)},ce=u=>{C("domain-update")&&(_.value={...u},i.value={name:u.name,domain_url:u.domain_url,site_id:u.site_id,timezone:u.timezone,wordpress_version:u.wordpress_version||"",plugin_version:u.plugin_version||"",is_active:u.is_active},I.value=!0)},fe=u=>{C("domain-delete")&&(_.value=u,T.value=!0)},_e=u=>{_.value=u,F.value=!0},h=async()=>{var u,e,n,s;g.value=!0,y.value=null;try{if(_.value){const v=await de(_.value.id,i.value);v.success?(I.value=!1,V.success("Domain updated successfully"),await A(((u=p.value)==null?void 0:u.current_page)||1,((e=p.value)==null?void 0:e.per_page)||15)):(y.value=v.error||"Failed to update domain",V.error(v.error||"Failed to update domain"))}else{const v=await ue(i.value);v.success?(S.value=!1,V.success("Domain created successfully"),await A(((n=p.value)==null?void 0:n.current_page)||1,((s=p.value)==null?void 0:s.per_page)||15)):(y.value=v.error||"Failed to create domain",V.error(v.error||"Failed to create domain"))}}catch(v){y.value=v instanceof Error?v.message:"Unexpected error",V.error(v instanceof Error?v.message:"Unexpected error")}finally{g.value=!1}},ge=async()=>{var u,e;if(_.value){g.value=!0,y.value=null;try{const n=await re(_.value.id);n.success?(T.value=!1,_.value=null,V.success("Domain deleted successfully"),await A(((u=p.value)==null?void 0:u.current_page)||1,((e=p.value)==null?void 0:e.per_page)||15)):(y.value=n.error||"Failed to delete domain",V.error(n.error||"Failed to delete domain"))}catch(n){y.value=n instanceof Error?n.message:"Unexpected error",V.error(n instanceof Error?n.message:"Unexpected error")}finally{g.value=!1}}},ye=async()=>{var u,e,n;if(_.value){g.value=!0;try{const s=await ve(_.value.id);s.success?(V.success("API key regenerated successfully"),_.value.api_key=(u=s.data)==null?void 0:u.api_key,await A(((e=p.value)==null?void 0:e.current_page)||1,((n=p.value)==null?void 0:n.per_page)||15)):V.error(s.error||"Failed to regenerate API key")}catch(s){V.error(s instanceof Error?s.message:"Unexpected error")}finally{g.value=!1}}},Ve=u=>{navigator.clipboard.writeText(u),V.success("API key copied to clipboard")},be=()=>{P.value="",z.value="all"};return Ae(()=>{A()}),(u,e)=>{const n=c("v-btn"),s=c("v-col"),v=c("v-row"),b=c("v-text-field"),$=c("v-select"),H=c("v-chip"),xe=c("v-progress-circular"),E=c("v-alert"),U=c("v-icon"),ke=c("v-table"),L=c("v-card-title"),Y=c("v-switch"),J=c("v-form"),N=c("v-card-text"),K=c("v-spacer"),j=c("v-card-actions"),R=c("v-card"),q=c("v-dialog");return f(),D("div",null,[l(v,{class:"mb-4"},{default:a(()=>[l(s,{cols:"12"},{default:a(()=>[o("div",Se,[e[26]||(e[26]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold"},"Domains"),o("p",{class:"text-body-1 text-medium-emphasis"}," Manage all domains and their configurations ")],-1)),r(C)("domain-create")?(f(),x(n,{key:0,color:"primary","prepend-icon":"mdi-plus",onClick:pe,size:"large"},{default:a(()=>e[25]||(e[25]=[d(" Add Domain ")])),_:1})):w("",!0)])]),_:1})]),_:1}),l(v,{class:"mb-6"},{default:a(()=>[l(s,{cols:"12"},{default:a(()=>[l(B,{title:"Filters"},{default:a(()=>[l(v,null,{default:a(()=>[l(s,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:P.value,"onUpdate:modelValue":e[0]||(e[0]=t=>P.value=t),label:"Search by name or URL","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l($,{modelValue:z.value,"onUpdate:modelValue":e[1]||(e[1]=t=>z.value=t),items:me,"item-title":"label","item-value":"value",label:"Status",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),l(v,null,{default:a(()=>[l(s,{cols:"12"},{default:a(()=>[o("div",Ie,[l(n,{variant:"outlined",onClick:be,"prepend-icon":"mdi-refresh"},{default:a(()=>e[27]||(e[27]=[d(" Clear Filters ")])),_:1}),l(H,{color:"primary",variant:"tonal",class:"ml-auto"},{default:a(()=>[d(m(M.value.length)+" domains found ",1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),r(ee)?(f(),x(v,{key:0},{default:a(()=>[l(s,{cols:"12"},{default:a(()=>[l(B,null,{default:a(()=>[o("div",Te,[l(xe,{indeterminate:"",color:"primary",size:"64"})])]),_:1})]),_:1})]),_:1})):r(W)?(f(),x(v,{key:1},{default:a(()=>[l(s,{cols:"12"},{default:a(()=>[l(B,null,{default:a(()=>[l(E,{type:"error",variant:"tonal",class:"mb-0"},{default:a(()=>[d(m(r(W)),1)]),_:1})]),_:1})]),_:1})]),_:1})):(f(),x(v,{key:2},{default:a(()=>[l(s,{cols:"12"},{default:a(()=>[l(B,{title:"Domains List"},{default:a(()=>[l(ke,{"fixed-header":"",height:"600px"},{default:a(()=>[e[32]||(e[32]=o("thead",null,[o("tr",null,[o("th",{class:"text-left"},"Name"),o("th",{class:"text-left"},"Domain URL"),o("th",{class:"text-left"},"Site ID"),o("th",{class:"text-left"},"Status"),o("th",{class:"text-left"},"Timezone"),o("th",{class:"text-left"},"Created At"),o("th",{class:"text-center"},"Actions")])],-1)),o("tbody",null,[(f(!0),D(Q,null,X(M.value,t=>(f(),D("tr",{key:t.id},[o("td",null,[o("div",Ee,m(t.name),1),o("div",Fe,m(t.slug),1)]),o("td",null,[o("a",{href:`https://${t.domain_url}`,target:"_blank",class:"text-primary"},m(t.domain_url),9,$e)]),o("td",null,m(t.site_id),1),o("td",null,[l(H,{color:t.statusColor,variant:"tonal",size:"small"},{default:a(()=>[d(m(t.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),o("td",null,m(t.timezone),1),o("td",null,m(t.createdDate),1),o("td",null,[o("div",Le,[l(n,{icon:"",size:"small",variant:"text",color:"success",onClick:O=>("navigateTo"in u?u.navigateTo:r(Pe))(`/domains/${t.id}/dashboard`),title:"View Dashboard"},{default:a(()=>[l(U,null,{default:a(()=>e[28]||(e[28]=[d("mdi-chart-box")])),_:1})]),_:2},1032,["onClick"]),l(n,{icon:"",size:"small",variant:"text",color:"info",onClick:O=>_e(t),title:"View API Key"},{default:a(()=>[l(U,null,{default:a(()=>e[29]||(e[29]=[d("mdi-key")])),_:1})]),_:2},1032,["onClick"]),r(C)("domain-update")?(f(),x(n,{key:0,icon:"",size:"small",variant:"text",color:"primary",onClick:O=>ce(t),title:"Edit"},{default:a(()=>[l(U,null,{default:a(()=>e[30]||(e[30]=[d("mdi-pencil")])),_:1})]),_:2},1032,["onClick"])):w("",!0),r(C)("domain-delete")?(f(),x(n,{key:1,icon:"",size:"small",variant:"text",color:"error",onClick:O=>fe(t),title:"Delete"},{default:a(()=>[l(U,null,{default:a(()=>e[31]||(e[31]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick"])):w("",!0)])])]))),128))])]),_:1}),r(p)&&r(p).last_page===1?(f(),D("div",Ne,[o("div",Ke," Total: "+m(r(p).total)+" domains ",1)])):w("",!0),r(p)&&r(p).last_page>1?(f(),D("div",je,[o("div",Re," Showing "+m(r(p).from)+" to "+m(r(p).to)+" of "+m(r(p).total)+" domains ",1),o("div",qe,[l($,{"model-value":r(p).per_page,"onUpdate:modelValue":r(oe),items:[10,15,25,50],variant:"outlined",density:"compact","hide-details":"",style:{width:"80px"}},null,8,["model-value","onUpdate:modelValue"]),l(n,{icon:"",variant:"text",disabled:!r(ie),onClick:r(ae),title:"Previous page"},{default:a(()=>[l(U,null,{default:a(()=>e[33]||(e[33]=[d("mdi-chevron-left")])),_:1})]),_:1},8,["disabled","onClick"]),o("div",Oe,[(f(!0),D(Q,null,X(r(se),t=>(f(),x(n,{key:t,color:t===r(p).current_page?"primary":void 0,variant:"text",size:"small",onClick:O=>r(te)(t)},{default:a(()=>[d(m(t),1)]),_:2},1032,["color","onClick"]))),128))]),l(n,{icon:"",variant:"text",disabled:!r(ne),onClick:r(le),title:"Next page"},{default:a(()=>[l(U,null,{default:a(()=>e[34]||(e[34]=[d("mdi-chevron-right")])),_:1})]),_:1},8,["disabled","onClick"])])])):w("",!0)]),_:1})]),_:1})]),_:1})),l(q,{modelValue:S.value,"onUpdate:modelValue":e[10]||(e[10]=t=>S.value=t),"max-width":"700px",scrollable:""},{default:a(()=>[l(R,null,{default:a(()=>[l(L,null,{default:a(()=>e[35]||(e[35]=[d("Create Domain")])),_:1}),l(N,null,{default:a(()=>[l(J,null,{default:a(()=>[l(v,null,{default:a(()=>[l(s,{cols:"12"},{default:a(()=>[l(b,{modelValue:i.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value.name=t),label:"Name",variant:"outlined",required:"",placeholder:"Ex: SmarterHome ISP",hint:"Slug will be auto-generated"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12"},{default:a(()=>[l(b,{modelValue:i.value.domain_url,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value.domain_url=t),label:"Domain URL",variant:"outlined",required:"",placeholder:"api.example.com",hint:"Without http:// or https://"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:i.value.site_id,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value.site_id=t),label:"Site ID (Optional)",variant:"outlined",placeholder:"wp-prod-example-001"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l($,{modelValue:i.value.timezone,"onUpdate:modelValue":e[5]||(e[5]=t=>i.value.timezone=t),items:G,label:"Timezone",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:i.value.wordpress_version,"onUpdate:modelValue":e[6]||(e[6]=t=>i.value.wordpress_version=t),label:"WordPress Version (Optional)",variant:"outlined",placeholder:"6.8.3"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:i.value.plugin_version,"onUpdate:modelValue":e[7]||(e[7]=t=>i.value.plugin_version=t),label:"Plugin Version (Optional)",variant:"outlined",placeholder:"2.0.0"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12"},{default:a(()=>[l(Y,{modelValue:i.value.is_active,"onUpdate:modelValue":e[8]||(e[8]=t=>i.value.is_active=t),label:"Active",color:"primary","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(j,null,{default:a(()=>[l(K),y.value?(f(),x(E,{key:0,type:"error",variant:"tonal",density:"compact",class:"mr-4"},{default:a(()=>[d(m(y.value),1)]),_:1})):w("",!0),l(n,{onClick:e[9]||(e[9]=t=>S.value=!1),disabled:g.value},{default:a(()=>e[36]||(e[36]=[d("Cancel")])),_:1},8,["disabled"]),l(n,{color:"primary",onClick:h,loading:g.value,disabled:g.value},{default:a(()=>e[37]||(e[37]=[d("Create")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(q,{modelValue:I.value,"onUpdate:modelValue":e[19]||(e[19]=t=>I.value=t),"max-width":"700px",scrollable:""},{default:a(()=>[l(R,null,{default:a(()=>[l(L,null,{default:a(()=>{var t;return[d("Edit Domain: "+m((t=_.value)==null?void 0:t.name),1)]}),_:1}),l(N,null,{default:a(()=>[l(J,null,{default:a(()=>[l(v,null,{default:a(()=>[l(s,{cols:"12"},{default:a(()=>[l(b,{modelValue:i.value.name,"onUpdate:modelValue":e[11]||(e[11]=t=>i.value.name=t),label:"Name",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),l(s,{cols:"12"},{default:a(()=>[l(b,{modelValue:i.value.domain_url,"onUpdate:modelValue":e[12]||(e[12]=t=>i.value.domain_url=t),label:"Domain URL",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:i.value.site_id,"onUpdate:modelValue":e[13]||(e[13]=t=>i.value.site_id=t),label:"Site ID",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l($,{modelValue:i.value.timezone,"onUpdate:modelValue":e[14]||(e[14]=t=>i.value.timezone=t),items:G,label:"Timezone",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:i.value.wordpress_version,"onUpdate:modelValue":e[15]||(e[15]=t=>i.value.wordpress_version=t),label:"WordPress Version",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l(b,{modelValue:i.value.plugin_version,"onUpdate:modelValue":e[16]||(e[16]=t=>i.value.plugin_version=t),label:"Plugin Version",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(s,{cols:"12"},{default:a(()=>[l(Y,{modelValue:i.value.is_active,"onUpdate:modelValue":e[17]||(e[17]=t=>i.value.is_active=t),label:"Active",color:"primary","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(j,null,{default:a(()=>[l(K),y.value?(f(),x(E,{key:0,type:"error",variant:"tonal",density:"compact",class:"mr-4"},{default:a(()=>[d(m(y.value),1)]),_:1})):w("",!0),l(n,{onClick:e[18]||(e[18]=t=>I.value=!1),disabled:g.value},{default:a(()=>e[38]||(e[38]=[d("Cancel")])),_:1},8,["disabled"]),l(n,{color:"primary",onClick:h,loading:g.value,disabled:g.value},{default:a(()=>e[39]||(e[39]=[d("Save Changes")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(q,{modelValue:T.value,"onUpdate:modelValue":e[21]||(e[21]=t=>T.value=t),"max-width":"400px"},{default:a(()=>[l(R,null,{default:a(()=>[l(L,null,{default:a(()=>e[40]||(e[40]=[d("Confirm Deletion")])),_:1}),l(N,null,{default:a(()=>{var t;return[e[41]||(e[41]=o("p",null,"Are you sure you want to delete this domain?",-1)),o("p",null,[o("strong",null,m((t=_.value)==null?void 0:t.name),1)]),y.value?(f(),x(E,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-4"},{default:a(()=>[d(m(y.value),1)]),_:1})):w("",!0)]}),_:1}),l(j,null,{default:a(()=>[l(K),l(n,{onClick:e[20]||(e[20]=t=>T.value=!1),disabled:g.value},{default:a(()=>e[42]||(e[42]=[d("Cancel")])),_:1},8,["disabled"]),l(n,{color:"error",onClick:ge,loading:g.value,disabled:g.value},{default:a(()=>e[43]||(e[43]=[d("Delete")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(q,{modelValue:F.value,"onUpdate:modelValue":e[24]||(e[24]=t=>F.value=t),"max-width":"600px"},{default:a(()=>[l(R,null,{default:a(()=>[l(L,null,{default:a(()=>{var t;return[d("API Key: "+m((t=_.value)==null?void 0:t.name),1)]}),_:1}),l(N,null,{default:a(()=>[_.value?(f(),D("div",Be,[l(E,{type:"info",variant:"tonal",class:"mb-4"},{default:a(()=>e[44]||(e[44]=[o("div",{class:"text-subtitle-2"},"Keep this key secure!",-1),o("div",{class:"text-caption"},"This key grants access to the domain's API.",-1)])),_:1}),l(b,{"model-value":_.value.api_key,label:"API Key",variant:"outlined",readonly:"","append-inner-icon":"mdi-content-copy","onClick:appendInner":e[22]||(e[22]=t=>Ve(_.value.api_key))},null,8,["model-value"]),o("div",We,[r(C)("domain-update")?(f(),x(n,{key:0,color:"warning",variant:"tonal","prepend-icon":"mdi-refresh",onClick:ye,loading:g.value},{default:a(()=>e[45]||(e[45]=[d(" Regenerate API Key ")])),_:1},8,["loading"])):w("",!0)])])):w("",!0)]),_:1}),l(j,null,{default:a(()=>[l(K),l(n,{onClick:e[23]||(e[23]=t=>F.value=!1)},{default:a(()=>e[46]||(e[46]=[d("Close")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{Ye as default};
