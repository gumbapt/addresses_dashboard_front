import{d as ge,v as be,f as ye,e as k,l as he,o as De,c as x,a as e,h as g,w as t,r as d,q as i,g as a,k as ke,i as b,j as u,t as n,F as M,m as O,b as m,_ as we}from"./aleRfsrb.js";import{_ as w}from"./BALEWVtA.js";import{u as Ve}from"./mLz8cD8d.js";import{u as Ce}from"./CbDAeH4C.js";const Pe={class:"d-flex gap-2"},Se={class:"d-flex justify-center align-center py-8"},Ne={class:"font-weight-medium"},Re={class:"font-weight-medium"},Ae={class:"text-caption text-medium-emphasis"},Fe={class:"d-flex justify-center gap-1"},Le={key:0,class:"d-flex justify-end mt-4"},je={class:"text-body-2 text-medium-emphasis"},Ee={key:1,class:"d-flex align-center justify-space-between mt-4"},Ue={class:"text-body-2 text-medium-emphasis"},ze={class:"d-flex align-center gap-2"},$e={class:"d-flex gap-1"},Be={class:"text-h5"},Me={key:0,class:"d-flex justify-center py-8"},Oe={key:1},Te={class:"mb-4"},Ge={class:"text-h6"},Ie={class:"mb-4"},Je={class:"text-h6"},qe={class:"mb-4"},He={class:"mb-4"},Ke={class:"text-caption"},Qe={class:"text-caption"},We={class:"text-caption text-medium-emphasis"},Xe=ge({__name:"index",setup(Ye){const{formattedReports:T,meta:c,loading:G,error:N,loadReports:R,loadReport:I,nextPage:J,prevPage:q,goToPage:H,changePerPage:K,canGoNext:Q,canGoPrev:W,pageNumbers:X}=Ve(),{domains:V,loadDomains:Y}=Ce();be();const C=ye(),s=k({domain_id:void 0,status:void 0,start_date:void 0,end_date:void 0,page:1,per_page:15}),y=k(!1),_=k(null),P=k(!1),Z=[{value:void 0,label:"All Status"},{value:"pending",label:"Pending"},{value:"processing",label:"Processing"},{value:"processed",label:"Processed"},{value:"failed",label:"Failed"}],ee=he(()=>{const r=[{value:void 0,label:"All Domains"}];return V.value&&Array.isArray(V.value)&&V.value.forEach(l=>{r.push({value:l.id,label:l.name})}),r}),A=()=>{s.value.page=1,R(s.value)},te=()=>{s.value={domain_id:void 0,status:void 0,start_date:void 0,end_date:void 0,page:1,per_page:15},A()},le=async r=>{y.value=!0,P.value=!0;try{const l=await I(r.id);l?_.value=l:(C.error("Failed to load report details"),y.value=!1)}catch{C.error("Error loading report details"),y.value=!1}finally{P.value=!1}},F=r=>r?JSON.stringify(r,null,2):"N/A",ae=r=>{C.info("Export feature coming soon")},oe=()=>{J(s.value),s.value.page=(s.value.page||1)+1},se=()=>{q(s.value),s.value.page=Math.max(1,(s.value.page||1)-1)},ne=r=>{H(r,s.value),s.value.page=r},de=r=>{K(r,s.value),s.value.per_page=r,s.value.page=1};return De(()=>{Y(),R(s.value)}),(r,l)=>{const v=d("v-col"),p=d("v-row"),S=d("v-select"),L=d("v-text-field"),f=d("v-btn"),D=d("v-chip"),ie=d("v-form"),j=d("v-progress-circular"),E=d("v-alert"),h=d("v-icon"),ue=d("v-table"),re=d("v-card-title"),U=d("v-expansion-panel-title"),z=d("v-expansion-panel-text"),$=d("v-expansion-panel"),ve=d("v-expansion-panels"),_e=d("v-divider"),me=d("v-card-text"),ce=d("v-spacer"),pe=d("v-card-actions"),fe=d("v-card"),xe=d("v-dialog");return m(),x("div",null,[e(p,{class:"mb-4"},{default:t(()=>[e(v,{cols:"12"},{default:t(()=>l[6]||(l[6]=[a("div",{class:"d-flex align-center justify-space-between"},[a("div",null,[a("h1",{class:"text-h4 font-weight-bold"},"Reports"),a("p",{class:"text-body-1 text-medium-emphasis"}," View and manage all domain reports ")])],-1)])),_:1})]),_:1}),e(p,{class:"mb-6"},{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(w,{title:"Filters"},{default:t(()=>[e(ie,{onSubmit:ke(A,["prevent"])},{default:t(()=>[e(p,null,{default:t(()=>[e(v,{cols:"12",md:"6",lg:"3"},{default:t(()=>[e(S,{modelValue:s.value.domain_id,"onUpdate:modelValue":l[0]||(l[0]=o=>s.value.domain_id=o),items:ee.value,"item-title":"label","item-value":"value",label:"Domain",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),e(v,{cols:"12",md:"6",lg:"3"},{default:t(()=>[e(S,{modelValue:s.value.status,"onUpdate:modelValue":l[1]||(l[1]=o=>s.value.status=o),items:Z,"item-title":"label","item-value":"value",label:"Status",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"6",lg:"3"},{default:t(()=>[e(L,{modelValue:s.value.start_date,"onUpdate:modelValue":l[2]||(l[2]=o=>s.value.start_date=o),label:"Start Date",type:"date",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"6",lg:"3"},{default:t(()=>[e(L,{modelValue:s.value.end_date,"onUpdate:modelValue":l[3]||(l[3]=o=>s.value.end_date=o),label:"End Date",type:"date",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[a("div",Pe,[e(f,{type:"submit",color:"primary","prepend-icon":"mdi-filter"},{default:t(()=>l[7]||(l[7]=[u(" Apply Filters ")])),_:1}),e(f,{variant:"outlined",onClick:te,"prepend-icon":"mdi-refresh"},{default:t(()=>l[8]||(l[8]=[u(" Clear Filters ")])),_:1}),i(c)?(m(),g(D,{key:0,color:"primary",variant:"tonal",class:"ml-auto"},{default:t(()=>[u(n(i(c).total)+" reports found ",1)]),_:1})):b("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(G)?(m(),g(p,{key:0},{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(w,null,{default:t(()=>[a("div",Se,[e(j,{indeterminate:"",color:"primary",size:"64"})])]),_:1})]),_:1})]),_:1})):i(N)?(m(),g(p,{key:1},{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(w,null,{default:t(()=>[e(E,{type:"error",variant:"tonal",class:"mb-0"},{default:t(()=>[u(n(i(N)),1)]),_:1})]),_:1})]),_:1})]),_:1})):(m(),g(p,{key:2},{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(w,{title:"Reports List"},{default:t(()=>[e(ue,{"fixed-header":"",height:"600px"},{default:t(()=>[l[11]||(l[11]=a("thead",null,[a("tr",null,[a("th",{class:"text-left"},"ID"),a("th",{class:"text-left"},"Domain"),a("th",{class:"text-left"},"Report Date"),a("th",{class:"text-left"},"Status"),a("th",{class:"text-left"},"Data Version"),a("th",{class:"text-left"},"Created At"),a("th",{class:"text-center"},"Actions")])],-1)),a("tbody",null,[(m(!0),x(M,null,O(i(T),o=>(m(),x("tr",{key:o.id},[a("td",null,[a("div",Ne,"#"+n(o.id),1)]),a("td",null,[a("div",Re,n(o.domainName),1),a("div",Ae,"ID: "+n(o.domain_id),1)]),a("td",null,n(o.reportDate),1),a("td",null,[e(D,{color:o.statusColor,variant:"tonal",size:"small"},{default:t(()=>[u(n(o.statusLabel),1)]),_:2},1032,["color"])]),a("td",null,[e(D,{size:"small",variant:"outlined"},{default:t(()=>[u(n(o.data_version),1)]),_:2},1024)]),a("td",null,n(o.createdDate),1),a("td",null,[a("div",Fe,[e(f,{icon:"",size:"small",variant:"text",color:"info",onClick:B=>le(o),title:"View Details"},{default:t(()=>[e(h,null,{default:t(()=>l[9]||(l[9]=[u("mdi-eye")])),_:1})]),_:2},1032,["onClick"]),e(f,{icon:"",size:"small",variant:"text",color:"primary",onClick:B=>ae(o),title:"Export"},{default:t(()=>[e(h,null,{default:t(()=>l[10]||(l[10]=[u("mdi-download")])),_:1})]),_:2},1032,["onClick"])])])]))),128))])]),_:1}),i(c)&&i(c).last_page===1?(m(),x("div",Le,[a("div",je," Total: "+n(i(c).total)+" reports ",1)])):b("",!0),i(c)&&i(c).last_page>1?(m(),x("div",Ee,[a("div",Ue," Showing "+n(i(c).from)+" to "+n(i(c).to)+" of "+n(i(c).total)+" reports ",1),a("div",ze,[e(S,{"model-value":s.value.per_page,"onUpdate:modelValue":de,items:[10,15,25,50,100],variant:"outlined",density:"compact","hide-details":"",style:{width:"80px"}},null,8,["model-value"]),e(f,{icon:"",variant:"text",disabled:!i(W),onClick:se,title:"Previous page"},{default:t(()=>[e(h,null,{default:t(()=>l[12]||(l[12]=[u("mdi-chevron-left")])),_:1})]),_:1},8,["disabled"]),a("div",$e,[(m(!0),x(M,null,O(i(X),o=>(m(),g(f,{key:o,color:o===i(c).current_page?"primary":void 0,variant:"text",size:"small",onClick:B=>ne(o)},{default:t(()=>[u(n(o),1)]),_:2},1032,["color","onClick"]))),128))]),e(f,{icon:"",variant:"text",disabled:!i(Q),onClick:oe,title:"Next page"},{default:t(()=>[e(h,null,{default:t(()=>l[13]||(l[13]=[u("mdi-chevron-right")])),_:1})]),_:1},8,["disabled"])])])):b("",!0)]),_:1})]),_:1})]),_:1})),e(xe,{modelValue:y.value,"onUpdate:modelValue":l[5]||(l[5]=o=>y.value=o),"max-width":"900px",scrollable:""},{default:t(()=>[e(fe,null,{default:t(()=>[e(re,null,{default:t(()=>{var o;return[a("span",Be,"Report Details #"+n((o=_.value)==null?void 0:o.id),1)]}),_:1}),e(me,null,{default:t(()=>[P.value?(m(),x("div",Me,[e(j,{indeterminate:"",color:"primary"})])):_.value?(m(),x("div",Oe,[e(p,null,{default:t(()=>[e(v,{cols:"12",md:"6"},{default:t(()=>{var o;return[a("div",Te,[l[14]||(l[14]=a("div",{class:"text-subtitle-2 text-medium-emphasis mb-1"},"Domain",-1)),a("div",Ge,n(((o=_.value.domain)==null?void 0:o.name)||"N/A"),1)])]}),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[a("div",Ie,[l[15]||(l[15]=a("div",{class:"text-subtitle-2 text-medium-emphasis mb-1"},"Report Date",-1)),a("div",Je,n(new Date(_.value.report_date).toLocaleDateString()),1)])]),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[a("div",qe,[l[16]||(l[16]=a("div",{class:"text-subtitle-2 text-medium-emphasis mb-1"},"Status",-1)),e(D,{color:r.getStatusColor(_.value.status),variant:"tonal"},{default:t(()=>[u(n(r.getStatusLabel(_.value.status)),1)]),_:1},8,["color"])])]),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[a("div",He,[l[17]||(l[17]=a("div",{class:"text-subtitle-2 text-medium-emphasis mb-1"},"Data Version",-1)),e(D,{variant:"outlined"},{default:t(()=>[u(n(_.value.data_version),1)]),_:1})])]),_:1}),_.value.error_message?(m(),g(v,{key:0,cols:"12"},{default:t(()=>[e(E,{type:"error",variant:"tonal"},{default:t(()=>[l[18]||(l[18]=a("div",{class:"text-subtitle-2 mb-1"},"Error Message",-1)),a("div",null,n(_.value.error_message),1)]),_:1})]),_:1})):b("",!0),e(v,{cols:"12"},{default:t(()=>[e(ve,null,{default:t(()=>[_.value.raw_data?(m(),g($,{key:0},{default:t(()=>[e(U,null,{default:t(()=>[e(h,{class:"mr-2"},{default:t(()=>l[19]||(l[19]=[u("mdi-file-code")])),_:1}),l[20]||(l[20]=u(" Raw Data "))]),_:1}),e(z,null,{default:t(()=>[a("pre",Ke,n(F(_.value.raw_data)),1)]),_:1})]),_:1})):b("",!0),_.value.processed_data?(m(),g($,{key:1},{default:t(()=>[e(U,null,{default:t(()=>[e(h,{class:"mr-2"},{default:t(()=>l[21]||(l[21]=[u("mdi-file-check")])),_:1}),l[22]||(l[22]=u(" Processed Data "))]),_:1}),e(z,null,{default:t(()=>[a("pre",Qe,n(F(_.value.processed_data)),1)]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1}),e(v,{cols:"12"},{default:t(()=>[e(_e,{class:"my-4"}),a("div",We,[a("div",null,"Created: "+n(new Date(_.value.created_at).toLocaleString()),1),a("div",null,"Updated: "+n(new Date(_.value.updated_at).toLocaleString()),1)])]),_:1})]),_:1})])):b("",!0)]),_:1}),e(pe,null,{default:t(()=>[e(ce),e(f,{onClick:l[4]||(l[4]=o=>y.value=!1)},{default:t(()=>l[23]||(l[23]=[u("Close")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),at=we(Xe,[["__scopeId","data-v-86bb2479"]]);export{at as default};
